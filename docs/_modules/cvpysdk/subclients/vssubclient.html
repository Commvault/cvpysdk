

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cvpysdk.subclients.vssubclient &mdash; Developer SDK - Python 11.19 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Developer SDK - Python
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Developer SDK - Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>cvpysdk.subclients.vssubclient</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for cvpysdk.subclients.vssubclient</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># --------------------------------------------------------------------------</span>
<span class="c1"># Copyright Commvault Systems, Inc.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1"># --------------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;File for operating on a Virtual Server Subclient.</span>

<span class="sd">VirualServerSubclient is the only class defined in this file.</span>

<span class="sd">VirtualServerSubclient: Derived class from Subclient Base class, representing a</span>
<span class="sd">                            virtual server subclient, and to perform operations</span>
<span class="sd">                            on that subclient</span>

<span class="sd">VirtualServerSubclient:</span>
<span class="sd">    __get_subclient_properties()      --  gets the subclient  related</span>
<span class="sd">                                          properties of VSA subclient.</span>

<span class="sd">    _get_subclient_properties_json()  --  gets all the subclient  related</span>
<span class="sd">                                          properties of VSA subclient.</span>

<span class="sd">    _get_vm_ids_and_names_dict()      --  creates and returns 2 dictionaries,</span>
<span class="sd">                                          along with the vm path</span>

<span class="sd">    _parse_vm_path()                  --  parses the path provided by user,</span>
<span class="sd">                                          and replaces the VM Display Name with</span>
<span class="sd">                                          the VM ID</span>

<span class="sd">    _json_restore_virtualServerRstOption    -- setter for Virtualserver</span>
<span class="sd">                                               property in restore</span>

<span class="sd">    _json_restore_diskLevelVMRestoreOption  -- setter for diskLevel restore</span>
<span class="sd">                                               property in restore</span>

<span class="sd">    _json_restore_advancedRestoreOptions    -- setter for advanced restore</span>
<span class="sd">                                               property in restore</span>

<span class="sd">    _json_restore_volumeRstOption           -- setter for Volume restore</span>
<span class="sd">                                               property in restore</span>

<span class="sd">    _json_vcenter_instance                  -- setter for vcenter instance</span>
<span class="sd">                                               json in restore</span>

<span class="sd">    _json_nics_advancedRestoreOptions       -- Setter for nics list for</span>
<span class="sd">                                               advanced restore option json</span>

<span class="sd">    _process_vsa_browse_response()          -- processes the browse response</span>
<span class="sd">                                               received from server,and</span>
<span class="sd">                                               replaces the vm id with the vm</span>
<span class="sd">                                               name</span>

<span class="sd">    _process_restore_request()              -- processes the Restore Request</span>
<span class="sd">                                               and replaces the VM</span>
<span class="sd">                                               display name with their ID</span>
<span class="sd">                                               before passing to the API</span>

<span class="sd">    _get_disk_Extension()                   -- Gets the Extension of disk</span>
<span class="sd">                                               provided</span>

<span class="sd">    _get_conversion_disk_Type()             -- For source Disk gets the Disk</span>
<span class="sd">                                               that can be converted to and</span>
<span class="sd">                                               set its destination Vendor</span>

<span class="sd">    _prepare_filelevel_restore_json()       -- internal Method can be used by</span>
<span class="sd">                                               subclasses for file level</span>
<span class="sd">                                               restore Json</span>

<span class="sd">    _prepare_disk_restore_json              -- internal Method can be used by</span>
<span class="sd">                                               subclasses for disk level</span>
<span class="sd">                                               restore Json</span>

<span class="sd">    _check_folder_in_browse                 -- Internal Method to check folder</span>
<span class="sd">                                               is in browse from subclient</span>

<span class="sd">    browse()                                -- gets the content of the backup</span>
<span class="sd">                                               for this subclient at the vm</span>
<span class="sd">                                               path specified</span>

<span class="sd">    parse_nics_xml()                        -- gets the list of nics for a VM</span>

<span class="sd">    get_nics_from_browse()                  -- Browses the vm to get the nics</span>
<span class="sd">                                               info xml, gets the nics info</span>
<span class="sd">                                               using the parse_nics_xml method</span>
<span class="sd">                                               and prepares the dict for nics</span>
<span class="sd">                                               json</span>

<span class="sd">    disk_level_browse()                     -- browses the Disks of a Virtual</span>
<span class="sd">                                               Machine</span>

<span class="sd">    guest_files_browse()                    -- browses the Files and Folders</span>
<span class="sd">                                               inside a Virtual Machine</span>


<span class="sd">    vm_files_browse()                       -- browses the Files and Folders</span>
<span class="sd">                                               of a Virtual Machine</span>

<span class="sd">    vm_files_browse_in_time()               -- browses the Files and Folders</span>
<span class="sd">                                               of a Virtual Machine in the time</span>
<span class="sd">                                               range specified</span>

<span class="sd">    restore_out_of_place()                  -- restores the VM Guest Files</span>
<span class="sd">                                               specified in the paths list to</span>
<span class="sd">                                               the client, at the</span>
<span class="sd">                                               specified destionation location</span>

<span class="sd">    full_vm_restore_in_place()              -- restores the VM specified by the</span>
<span class="sd">                                               user to the same location</span>

<span class="sd">    backup()                               --  run a backup job for the subclient</span>

<span class="sd">    _advanced_backup_options()              --  sets the advanced backup options</span>


<span class="sd">To add a new Virtual Subclient,  create a class in a new module under virtualserver sub package</span>


<span class="sd">The new module which is created has to named in the following manner:</span>
<span class="sd">1. Name the module with the name of the Virtual Server without special characters</span>
<span class="sd">2.Spaces alone must be replaced with underscores(&#39;_&#39;)</span>

<span class="sd">For eg:</span>

<span class="sd">    The Virtual Server &#39;Red Hat Virtualization&#39; is named as &#39;red_hat_virtualization.py&#39;</span>

<span class="sd">    The Virtual Server &#39;Hyper-V&#39; is named as &#39;hyperv.py&#39;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="k">import</span> <span class="n">Enum</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="k">import</span> <span class="n">import_module</span>
<span class="kn">from</span> <span class="nn">inspect</span> <span class="k">import</span> <span class="n">getmembers</span><span class="p">,</span> <span class="n">isclass</span><span class="p">,</span> <span class="n">isabstract</span>

<span class="kn">import</span> <span class="nn">xmltodict</span>
<span class="kn">from</span> <span class="nn">past.builtins</span> <span class="k">import</span> <span class="n">basestring</span>

<span class="kn">from</span> <span class="nn">cvpysdk.plan</span> <span class="k">import</span> <span class="n">Plans</span>
<span class="kn">from</span> <span class="nn">..exception</span> <span class="k">import</span> <span class="n">SDKException</span>
<span class="kn">from</span> <span class="nn">..subclient</span> <span class="k">import</span> <span class="n">Subclient</span>
<span class="kn">from</span> <span class="nn">..constants</span> <span class="k">import</span> <span class="n">VSAObjects</span>


<div class="viewcode-block" id="VirtualServerSubclient"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient">[docs]</a><span class="k">class</span> <span class="nc">VirtualServerSubclient</span><span class="p">(</span><span class="n">Subclient</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Derived class from Subclient Base class, representing a virtual server subclient,</span>
<span class="sd">        and to perform operations on that subclient.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">backupset_object</span><span class="p">,</span> <span class="n">subclient_name</span><span class="p">,</span> <span class="n">subclient_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Decides which instance object needs to be created&quot;&quot;&quot;</span>
        <span class="n">instance_name</span> <span class="o">=</span> <span class="n">backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">instance_name</span>
        <span class="n">instance_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[^A-Za-z0-9_]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">instance_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">subclient_module</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;cvpysdk.subclients.virtualserver.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">instance_name</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">subclient_module</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;cvpysdk.subclients.virtualserver.null&quot;</span><span class="p">)</span>

        <span class="n">classes</span> <span class="o">=</span> <span class="n">getmembers</span><span class="p">(</span><span class="n">subclient_module</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">isclass</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isabstract</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">_class</span><span class="p">,</span> <span class="n">VirtualServerSubclient</span><span class="p">)</span> <span class="ow">and</span> <span class="n">_class</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">instance_name</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_class</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backupset_object</span><span class="p">,</span> <span class="n">subclient_name</span><span class="p">,</span> <span class="n">subclient_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the Instance object for the given Virtual Server instance.</span>

<span class="sd">            Args:</span>
<span class="sd">                backupset_object    (object)    --  instance of the backupset class</span>

<span class="sd">                subclient_name      (str)       --  subclient name</span>

<span class="sd">                subclient_id        (int)       --  subclient id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VirtualServerSubclient</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">backupset_object</span><span class="p">,</span> <span class="n">subclient_name</span><span class="p">,</span> <span class="n">subclient_id</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Host&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="s1">&#39;Resource Pool&#39;</span><span class="p">,</span>
            <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="s1">&#39;Datacenter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="s1">&#39;Virtual Machine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;16&#39;</span><span class="p">:</span> <span class="s1">&#39;All unprotected VMs&#39;</span><span class="p">,</span>
            <span class="s1">&#39;17&#39;</span><span class="p">:</span> <span class="s1">&#39;Root&#39;</span><span class="p">,</span>
            <span class="s1">&#39;34&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span>
            <span class="s1">&#39;35&#39;</span><span class="p">:</span> <span class="s1">&#39;TagCategory&#39;</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filter_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Datastore&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="s1">&#39;Virtual Disk Name/Pattern&#39;</span><span class="p">,</span>
            <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="s1">&#39;Virtual Device Node&#39;</span><span class="p">,</span>
            <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="s1">&#39;Repository&#39;</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_disk_option</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;original&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;thicklazyzero&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;thin&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;thickeagerzero&#39;</span><span class="p">:</span> <span class="mi">3</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_transport_mode</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;auto&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;san&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;hotadd&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;nbd&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;nbdssl&#39;</span><span class="p">:</span> <span class="mi">4</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vm_names_browse</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vm_ids_browse</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_live_sync</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="VirtualServerSubclient.disk_pattern"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.disk_pattern">[docs]</a>    <span class="k">class</span> <span class="nc">disk_pattern</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        stores the disk pattern of all hypervisors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span>
        <span class="n">datastore</span> <span class="o">=</span> <span class="s2">&quot;Datastore&quot;</span>
        <span class="n">new_name</span> <span class="o">=</span> <span class="s2">&quot;newName&quot;</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the appropriate content from the Subclient relevant to the user.</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of content associated with the subclient</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">content</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">subclient_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmContent</span>

        <span class="k">if</span> <span class="s1">&#39;children&#39;</span> <span class="ow">in</span> <span class="n">subclient_content</span><span class="p">:</span>
            <span class="n">children</span> <span class="o">=</span> <span class="n">subclient_content</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span>
            <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_content_list</span><span class="p">(</span><span class="n">children</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">content</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">subclient_proxy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Gets the List of proxies at the Subclient</span>

<span class="sd">            Returns:</span>
<span class="sd">                    list         (list) :    Proxies at the subclient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_subclient_proxies</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instance_proxy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the proxy at instance level</span>

<span class="sd">        Returns:</span>
<span class="sd">                string          (string) :      Proxy at instane</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_proxyClient</span><span class="p">[</span><span class="s1">&#39;clientName&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vm_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the appropriate filter from the Subclient relevant to the user.</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of filter associated with the subclient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vm_filter</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmFilter</span><span class="p">:</span>
            <span class="n">subclient_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmFilter</span>
            <span class="k">if</span> <span class="s1">&#39;children&#39;</span> <span class="ow">in</span> <span class="n">subclient_filter</span><span class="p">:</span>
                <span class="n">children</span> <span class="o">=</span> <span class="n">subclient_filter</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span>
                <span class="n">vm_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_content_list</span><span class="p">(</span><span class="n">children</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vm_filter</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vm_diskfilter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the appropriate Diskfilter from the Subclient relevant to the user.</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of Diskfilter associated with the subclient</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vm_diskfilter</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmDiskFilter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subclient_diskfilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmDiskFilter</span>

            <span class="k">if</span> <span class="s1">&#39;filters&#39;</span> <span class="ow">in</span> <span class="n">subclient_diskfilter</span><span class="p">:</span>
                <span class="n">filters</span> <span class="o">=</span> <span class="n">subclient_diskfilter</span><span class="p">[</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
                    <span class="n">filter_type_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="s1">&#39;filterType&#39;</span><span class="p">])</span>
                    <span class="n">filter_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_types</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="s1">&#39;filterType&#39;</span><span class="p">])]</span>
                    <span class="n">vm_id</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;vmGuid&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;vmGuid&#39;</span> <span class="ow">in</span> <span class="n">child</span> <span class="k">else</span> <span class="kc">None</span>
                    <span class="n">filter_name</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;filter&#39;</span><span class="p">]</span>

                    <span class="n">temp_dict</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;filter&#39;</span><span class="p">:</span> <span class="n">filter_name</span><span class="p">,</span>
                        <span class="s1">&#39;filterType&#39;</span><span class="p">:</span> <span class="n">filter_type</span><span class="p">,</span>
                        <span class="s1">&#39;vmGuid&#39;</span><span class="p">:</span> <span class="n">vm_id</span><span class="p">,</span>
                        <span class="s1">&#39;filterTypeId&#39;</span><span class="p">:</span> <span class="n">filter_type_id</span>
                    <span class="p">}</span>

                    <span class="n">vm_diskfilter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vm_diskfilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmDiskFilter</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm_diskfilter</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vm_diskfilter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">vm_diskfilter</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cbtvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get CBT value for given subclient. Returns status as True/False (string)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_subclient_properties</span><span class="p">()</span>
        <span class="n">cbt_attr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;useChangedTrackingOnVM&#39;</span>
        <span class="n">vsasubclient_cbt_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vsaSubclientProp</span><span class="p">[</span><span class="n">cbt_attr</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">vsasubclient_cbt_status</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Get if collect files/metadata value for given subclient.</span>
<span class="sd">            Returns status as True/False (string)</span>
<span class="sd">            Default: False for subclient which doesnt have the property</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">collectdetails</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;collectFileDetails&#39;</span>
        <span class="k">if</span> <span class="n">collectdetails</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vsaSubclientProp</span><span class="p">:</span>
            <span class="n">vsasubclient_collect_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vsaSubclientProp</span><span class="p">[</span><span class="n">collectdetails</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vsasubclient_collect_details</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">vsasubclient_collect_details</span>

    <span class="nd">@content</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subclient_content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the list of content JSON to pass to the API to add/update</span>
<span class="sd">           content of a Virtual Server Subclient.</span>

<span class="sd">            Args:</span>
<span class="sd">                subclient_content (list)  --  list of the content to add to the</span>
<span class="sd">                subclient list should contain name and type</span>
<span class="sd">                (like VSAObjects.VMName, VSAObjects.DATASTORE )</span>
<span class="sd">                example:[</span>
<span class="sd">                            {</span>
<span class="sd">                            &#39;type&#39; : VSAObjects.VMNotes,</span>
<span class="sd">                            &#39;display_name&#39; : &#39;removed&#39;,</span>
<span class="sd">                            }</span>
<span class="sd">                        ]</span>

<span class="sd">                for Advance user:</span>
<span class="sd">                        where we need to have multiple constraints for a single</span>
<span class="sd">                        rule.</span>
<span class="sd">                        list should contain minimum 2 parameters (name, type,</span>
<span class="sd">                        true/False for equalsOrNotEquals) for a single</span>
<span class="sd">                        constraint</span>
<span class="sd">                        for power on/off, we need to specify one more</span>
<span class="sd">                        parameter i.e., true -on, false -off(as state variable)</span>
<span class="sd">                        example:</span>
<span class="sd">                        subclient_content = [</span>
<span class="sd">                            [</span>
<span class="sd">                                {</span>
<span class="sd">                                &#39;type&#39; : VSAObjects.VMName,</span>
<span class="sd">                                &#39;display_name&#39; : &#39;VM*&#39;</span>
<span class="sd">                                }</span>
<span class="sd">                            ],</span>
<span class="sd">                            [</span>
<span class="sd">                                {</span>
<span class="sd">                                  &#39;type&#39; : VSAObjects.VMNotes,</span>
<span class="sd">                                  &#39;display_name&#39; : &#39;removed&#39;,</span>
<span class="sd">                                },</span>
<span class="sd">                                {</span>
<span class="sd">                                  &#39;type&#39; : VSAObjects.VMPowerState,</span>
<span class="sd">                                  &#39;state&#39;: &#39;false&#39;,</span>
<span class="sd">                                }</span>
<span class="sd">                            ]</span>
<span class="sd">                        ]</span>



<span class="sd">            Returns:</span>
<span class="sd">                list - list of the appropriate JSON for an agent to send to the</span>
<span class="sd">                       POST Subclient API</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">content</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">subclient_content</span><span class="p">:</span>
                <span class="n">virtual_server_dict</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">virtual_server_dict</span><span class="p">[</span><span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                    <span class="s1">&#39;equalsOrNotEquals&#39;</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;equalsOrNotEquals&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;displayName&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">VSAObjects</span><span class="o">.</span><span class="n">VMNotes</span><span class="p">:</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;displayName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Notes&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span>
                        <span class="n">VSAObjects</span><span class="o">.</span><span class="n">VMPowerState</span> <span class="ow">and</span>
                        <span class="n">item</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span><span class="p">):</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PoweredState&quot;</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;displayName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Powered On&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span>
                        <span class="n">VSAObjects</span><span class="o">.</span><span class="n">VMPowerState</span> <span class="ow">and</span>
                        <span class="n">item</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;false&#39;</span><span class="p">):</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PoweredState&quot;</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;displayName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Powered Off&quot;</span>
                <span class="n">virtual_server_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">virtual_server_dict</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;102&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> not given in content&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>

        <span class="n">vs_subclient_content</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="n">content</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_subclient_properties</span><span class="p">(</span><span class="s2">&quot;_vmContent&quot;</span><span class="p">,</span> <span class="n">vs_subclient_content</span><span class="p">)</span>

    <span class="nd">@vm_filter</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">vm_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subclient_filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the list of Filter JSON to pass to the API to update the</span>
<span class="sd">           VM_filter of a Virtual Server Subclient. i.e. it works in overwrite</span>
<span class="sd">           mode</span>

<span class="sd">            Args:</span>
<span class="sd">                subclient_filter (list)  --  list of the filter to add to the</span>
<span class="sd">                                             subclient</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of the appropriate JSON for an agent to send to the</span>
<span class="sd">                       POST Subclient API</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vm_filter</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">temp_dict</span> <span class="ow">in</span> <span class="n">subclient_filter</span><span class="p">:</span>
                <span class="n">content_type_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">type_id</span><span class="p">,</span> <span class="n">type_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_types</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">type_name</span> <span class="o">==</span> <span class="n">temp_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]:</span>
                        <span class="n">content_type_id</span> <span class="o">=</span> <span class="n">type_id</span>
                        <span class="k">break</span>

                <span class="n">virtual_server_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;equalsOrNotEquals&#39;</span><span class="p">:</span> <span class="n">temp_dict</span><span class="p">[</span><span class="s2">&quot;equal_value&quot;</span><span class="p">],</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">temp_dict</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;displayName&#39;</span><span class="p">:</span> <span class="n">temp_dict</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">temp_dict</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">content_type_id</span>
                <span class="p">}</span>

                <span class="n">vm_filter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">virtual_server_dict</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;102&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> not given in content&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>

        <span class="n">vs_filter_content</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="n">vm_filter</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_subclient_properties</span><span class="p">(</span><span class="s2">&quot;_vmFilter&quot;</span><span class="p">,</span> <span class="n">vs_filter_content</span><span class="p">)</span>

    <span class="nd">@vm_diskfilter</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">vm_diskfilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subclient_diskfilter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the list of Disk Filter JSON to pass to the API to update</span>
<span class="sd">           the Disk_filter of a Virtual Server Subclient. i.e. it works in</span>
<span class="sd">           overwrite mode</span>

<span class="sd">            Args:</span>
<span class="sd">                subclient_diskfilter (list)  --  list of the Disk filter to add</span>
<span class="sd">                                                 to the subclient</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of the appropriate JSON for an agent to send to</span>
<span class="sd">                       the POST Subclient API</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vm_diskfilter</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">temp_dict</span> <span class="ow">in</span> <span class="n">subclient_diskfilter</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">type_id</span><span class="p">,</span> <span class="n">type_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_types</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">type_name</span> <span class="o">==</span> <span class="n">temp_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]:</span>
                        <span class="n">filter_type_id</span> <span class="o">=</span> <span class="n">type_id</span>
                        <span class="k">break</span>

                <span class="n">virtual_server_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;filter&#39;</span><span class="p">:</span> <span class="n">temp_dict</span><span class="p">[</span><span class="s1">&#39;filter&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;filterType&#39;</span><span class="p">:</span> <span class="n">filter_type_id</span><span class="p">,</span>
                    <span class="s1">&#39;vmGuid&#39;</span><span class="p">:</span> <span class="n">temp_dict</span><span class="p">[</span><span class="s1">&#39;vmGuid&#39;</span><span class="p">]</span>
                <span class="p">}</span>

                <span class="n">vm_diskfilter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">virtual_server_dict</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;102&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> not given in content&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>

        <span class="n">vs_diskfilter_content</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="n">vm_diskfilter</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_subclient_properties</span><span class="p">(</span><span class="s2">&quot;_vmDiskFilter&quot;</span><span class="p">,</span> <span class="n">vs_diskfilter_content</span><span class="p">)</span>

    <span class="nd">@cbtvalue</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cbtvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set given value (enabled/disabled) on the subclient</span>

<span class="sd">        Args:</span>
<span class="sd">                value   (int)   - enabled(1)/disabled(0)</span>

<span class="sd">        Raise Exception:</span>
<span class="sd">                If unable to set the give CBT value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cbt_status</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">cbt_attr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;useChangedTrackingOnVM&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_subclient_properties</span><span class="p">(</span><span class="s2">&quot;_vsaSubclientProp[&#39;useChangedTrackingOnVM&#39;]&quot;</span><span class="p">,</span>
                                           <span class="n">cbt_status</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">live_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the instance of the VSALiveSync class&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_live_sync</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.virtualserver.livesync.vsa_live_sync</span> <span class="k">import</span> <span class="n">VsaLiveSync</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_live_sync</span> <span class="o">=</span> <span class="n">VsaLiveSync</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_live_sync</span>

    <span class="k">def</span> <span class="nf">_get_disk_provisioning_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">provisioningType</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Returns the provisioning code for the selected type</span>

<span class="sd">        Args:</span>
<span class="sd">                provisioningType  (String) - Disk provisioning type</span>

<span class="sd">        return: (int) - diskProvisionValue</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Defaults to &quot;original&quot;</span>
        <span class="n">disk_provision_value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">provisioningType</span> <span class="o">=</span> <span class="n">provisioningType</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">provisioningType</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disk_option</span><span class="p">:</span>
            <span class="n">disk_provision_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disk_option</span><span class="p">[</span><span class="n">provisioningType</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">disk_provision_value</span>

    <span class="nd">@metadata</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set given value of collectFileDetails/metadata (True/false) on the subclient</span>

<span class="sd">        Args:</span>
<span class="sd">                value   (str)    True/False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">collectdetails</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;collectFileDetails&#39;</span>
        <span class="k">if</span> <span class="n">collectdetails</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vsaSubclientProp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_subclient_properties</span><span class="p">(</span><span class="s2">&quot;_vsaSubclientProp[&#39;collectFileDetails&#39;]&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_content_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">children</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the content in list format</span>
<span class="sd">        Args:</span>
<span class="sd">            children                            (list):     Content if the subclient</span>

<span class="sd">        Returns:</span>
<span class="sd">            content_list                        (list):     Content of the subclient</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">content_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;path&#39;</span> <span class="ow">in</span> <span class="n">child</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">allOrAnyChildren</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;allOrAnyChildren&#39;</span> <span class="ow">in</span> <span class="n">child</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">_temp_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">_temp_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="s1">&#39;children&#39;</span> <span class="ow">in</span> <span class="n">child</span><span class="p">:</span>
                <span class="n">nested_children</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">each_condition</span> <span class="ow">in</span> <span class="n">nested_children</span><span class="p">:</span>
                    <span class="n">display_name</span> <span class="o">=</span> <span class="n">each_condition</span><span class="p">[</span><span class="s1">&#39;displayName&#39;</span><span class="p">]</span>
                    <span class="n">content_type</span> <span class="o">=</span> <span class="n">VSAObjects</span><span class="p">(</span><span class="n">each_condition</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">name</span>
                    <span class="n">vm_id</span> <span class="o">=</span> <span class="n">each_condition</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                    <span class="n">temp_dict</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;equal_value&#39;</span><span class="p">:</span> <span class="n">each_condition</span><span class="p">[</span><span class="s1">&#39;equalsOrNotEquals&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">:</span> <span class="n">each_condition</span><span class="p">[</span><span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">vm_id</span><span class="p">,</span>
                        <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
                        <span class="s1">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">display_name</span><span class="p">,</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">content_type</span>
                    <span class="p">}</span>
                    <span class="n">_temp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dict</span><span class="p">)</span>
                <span class="n">_temp_dict</span><span class="p">[</span><span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allOrAnyChildren</span>
                <span class="n">_temp_dict</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_temp_list</span>
                <span class="n">content_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_temp_dict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">display_name</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;displayName&#39;</span><span class="p">]</span>
                <span class="n">content_type</span> <span class="o">=</span> <span class="n">VSAObjects</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">name</span>
                <span class="n">vm_id</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">temp_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;equal_value&#39;</span><span class="p">:</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;equalsOrNotEquals&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">:</span> <span class="n">child</span><span class="p">[</span><span class="s1">&#39;allOrAnyChildren&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">vm_id</span><span class="p">,</span>
                    <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
                    <span class="s1">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">display_name</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">content_type</span>
                <span class="p">}</span>
                <span class="n">content_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">content_list</span>

    <span class="k">def</span> <span class="nf">_get_subclient_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the subclient  related properties of File System subclient.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vmDiskFilter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vmFilter</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">VirtualServerSubclient</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_get_subclient_properties</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;vmContent&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vmContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">[</span><span class="s1">&#39;vmContent&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;vmDiskFilter&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vmDiskFilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">[</span><span class="s1">&#39;vmDiskFilter&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;vmFilter&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vmFilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">[</span><span class="s1">&#39;vmFilter&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;vmBackupInfo&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vmBackupInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">[</span><span class="s1">&#39;vmBackupInfo&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;vsaSubclientProp&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vsaSubclientProp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_properties</span><span class="p">[</span><span class="s1">&#39;vsaSubclientProp&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_subclient_content_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the subclient content from property. Base class Abstract method</span>
<span class="sd">        implementation</span>

<span class="sd">        return:</span>
<span class="sd">            VM content  (dict)  -- Dictionary of VM Content with all details</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span>

    <span class="k">def</span> <span class="nf">_get_subclient_properties_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the all subclient related properties of this subclient.</span>

<span class="sd">           Returns:</span>
<span class="sd">                dict - all subclient properties put inside a dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">subclient_json</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;subClientProperties&quot;</span><span class="p">:</span>
                <span class="p">{</span>
                    <span class="s2">&quot;vmContent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmContent</span><span class="p">,</span>
                    <span class="s2">&quot;proxyClient&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_proxyClient</span><span class="p">,</span>
                    <span class="s2">&quot;subClientEntity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subClientEntity</span><span class="p">,</span>
                    <span class="s2">&quot;vmDiskFilter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmDiskFilter</span><span class="p">,</span>
                    <span class="s2">&quot;vmFilter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmFilter</span><span class="p">,</span>
                    <span class="s2">&quot;vmBackupInfo&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmBackupInfo</span><span class="p">,</span>
                    <span class="s2">&quot;vsaSubclientProp&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vsaSubclientProp</span><span class="p">,</span>
                    <span class="c1"># &quot;content&quot;: self._content,</span>
                    <span class="s2">&quot;commonProperties&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commonProperties</span><span class="p">,</span>
                    <span class="s2">&quot;vmContentOperationType&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;vmDiskFilterOperationType&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;vmFilterOperationType&quot;</span><span class="p">:</span> <span class="mi">1</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">subclient_json</span>

    <span class="k">def</span> <span class="nf">_disk_dict_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">datastore</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the disk dictionary of the hypervisor</span>

<span class="sd">        Args:</span>
<span class="sd">                name            (str)       --  name of the disk</span>

<span class="sd">                datastore       (str)       --  datastore where the disk has to be restored</span>

<span class="sd">                new_name        (str)       --  new name of the disk</span>

<span class="sd">            Returns:</span>

<span class="sd">                disk dictionary(dict)       -- Dictionary with key name, new name , datastore</span>
<span class="sd">                                                and corresponding</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_name</span><span class="p">:</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="n">temp_disk_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">temp_disk_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">disk_pattern</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">temp_disk_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">disk_pattern</span><span class="o">.</span><span class="n">datastore</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">datastore</span>
        <span class="n">temp_disk_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">disk_pattern</span><span class="o">.</span><span class="n">new_name</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_name</span>
        <span class="k">return</span> <span class="n">temp_disk_dict</span>

    <span class="k">def</span> <span class="nf">_json_vcenter_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Setter for vcenter_instance JSON &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;vCenterInstance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;clientName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_client_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;instanceName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_instance&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;appName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;appName&quot;</span><span class="p">,</span> <span class="s2">&quot;Virtual Server&quot;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_instance_id&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_client_id&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;vCenterInstance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;instanceId&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_instance_id&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                 <span class="s2">&quot;clientId&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_client_id&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_json_restore_virtualServerRstOption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            setter for  the Virtual server restore  option in restore json</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;isDiskBrowse&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disk_browse&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
            <span class="s2">&quot;isFileBrowse&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_browse&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;isVolumeBrowse&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;isVirtualLab&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;virtual_lab&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;esxServer&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;esx_server&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;isAttachToNewVM&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attach_to_new_vm&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;viewType&quot;</span><span class="p">:</span> <span class="s2">&quot;DEFAULT&quot;</span><span class="p">,</span>
            <span class="s2">&quot;isBlockLevelReplication&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_level&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;replication_guid&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s1">&#39;replicationGuid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;replication_guid&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_json_restore_virtualServerRstOption_filelevelrestoreoption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            setter for  the File level restore option for agent less restore option in restore json</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;serverName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;server_name&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="s2">&quot;vmGuid&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vm_guid&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="s2">&quot;vmName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vm_name&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_json_restore_guest_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            setter for vm credentials for agentless restore option in restore json</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;userName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_name&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_json_nics_advancedRestoreOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_to_restore</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Setter for nics list for advanced restore option json</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">nics_dict_from_browse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nics_from_browse</span><span class="p">()</span>
        <span class="n">nics_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vm_nics_list</span> <span class="o">=</span> <span class="n">nics_dict_from_browse</span><span class="p">[</span><span class="n">vm_to_restore</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">network_card_dict</span> <span class="ow">in</span> <span class="n">vm_nics_list</span><span class="p">:</span>
            <span class="n">_destnetwork</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_network&quot;</span><span class="p">,</span>
                                     <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;network&#39;</span><span class="p">,</span>
                                               <span class="n">network_card_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>

            <span class="n">nics</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;subnetId&quot;</span><span class="p">:</span> <span class="n">network_card_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subnetId&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="s2">&quot;sourceNetwork&quot;</span><span class="p">:</span> <span class="n">network_card_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="s2">&quot;sourceNetworkId&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;networkName&quot;</span><span class="p">:</span><span class="n">_destnetwork</span> <span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">network_card_dict</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
                <span class="s2">&quot;networkName&quot;</span><span class="p">:</span> <span class="n">_destnetwork</span><span class="p">,</span>
                <span class="s2">&quot;destinationNetwork&quot;</span><span class="p">:</span> <span class="n">_destnetwork</span>
            <span class="p">}</span>

            <span class="n">nics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nics</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nics_list</span>

    <span class="k">def</span> <span class="nf">_json_vmip_advanced_restore_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Setting IP for destination vm</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vmip</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vm_ip</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;sourceIP&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source_ip&quot;</span><span class="p">),</span>
            <span class="s2">&quot;sourceSubnet&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source_subnet&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*.*.*&quot;</span><span class="p">),</span>
            <span class="s2">&quot;sourceGateway&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source_gateway&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*.*.*&quot;</span><span class="p">),</span>
            <span class="s2">&quot;destinationIP&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_ip&quot;</span><span class="p">),</span>
            <span class="s2">&quot;destinationSubnet&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_subnet&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*.*.*&quot;</span><span class="p">),</span>
            <span class="s2">&quot;destinationGateway&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_subnet&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*.*.*&quot;</span><span class="p">),</span>
            <span class="s2">&quot;primaryDNS&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;primary_dns&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;alternateDNS&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alternate_dns&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;primaryWins&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;primare_wins&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;altenameWins&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alternate_wins&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;useDhcp&quot;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
        <span class="n">vmip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vm_ip</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vmip</span>

    <span class="k">def</span> <span class="nf">_json_restore_diskLevelVMRestoreOption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;setter for  the disk Level VM Restore Option    in restore json&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="n">json_disklevel_option_restore</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;esxServerName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;esx_server_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;vmFolderName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vm_folder&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;dataCenterName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_center&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;hostOrCluster&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;host_cluster&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;diskOption&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disk_option&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">&quot;vmName&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transportMode&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;transport_mode&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">&quot;passUnconditionalOverride&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unconditional_overwrite&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;powerOnVmAfterRestore&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;power_on&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;registerWithFailoverCluster&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;add_to_failover&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;userPassword&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;userName&quot;</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;in_place&#39;</span><span class="p">]:</span>
            <span class="n">json_disklevel_option_restore</span><span class="p">[</span><span class="s2">&quot;dataStore&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;distribute_vm_workload&#39;</span><span class="p">):</span>
            <span class="n">json_disklevel_option_restore</span><span class="p">[</span><span class="s2">&quot;maxNumOfVMPerJob&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;distribute_vm_workload&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;diskLevelVMRestoreOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_disklevel_option_restore</span>

    <span class="k">def</span> <span class="nf">_json_restore_attach_diskLevelVMRestoreOption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;setter for the attach disk Level VM Restore Option in restore json&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="n">json_disklevel_option_restore</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;esxServerName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;esxHost&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;diskOption&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disk_option&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">&quot;passUnconditionalOverride&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unconditional_overwrite&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;powerOnVmAfterRestore&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;power_on&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;transportMode&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;transport_mode&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">&quot;userPassword&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;userName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;userName&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;password&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)}</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;diskLevelVMRestoreOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_disklevel_option_restore</span>

    <span class="k">def</span> <span class="nf">_json_restore_advancedRestoreOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;setter for the Virtual server restore  option in restore json&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;disks&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disks&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s2">&quot;guid&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;guid&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;newGuid&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new_guid&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;newName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;esxHost&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;esx_host&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;cluster&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;nics&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nics&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s2">&quot;vmIPAddressOptions&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vm_ip_address_options&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="s2">&quot;FolderPath&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FolderPath&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ResourcePool&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">value_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;createPublicIP&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;createPublicIP&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;createPublicIP&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;restoreAsManagedVM&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;restoreAsManagedVM&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;restoreAsManagedVM&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;destination_os_name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;osName&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;destination_os_name&quot;</span><span class="p">,</span> <span class="s2">&quot;AUTO&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;datacenter&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;datacenter&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;datacenter&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;terminationProtected&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;terminationProtected&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;terminationProtected&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]],</span>
            <span class="s2">&quot;securityGroups&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;securityGroups&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;securityGroups&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;keyPairList&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;keyPairList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;keyPairList&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]]</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">value_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">inner_key</span> <span class="o">=</span> <span class="n">value_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">val1</span><span class="p">,</span> <span class="n">val2</span> <span class="o">=</span> <span class="n">value_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">value_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="n">inner_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;vmSize&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">val1</span><span class="p">,</span> <span class="n">val2</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;instanceSize&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;vmSize&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;vmSize&quot;</span><span class="p">,</span> <span class="s2">&quot;vmSize&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;vmSize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;ami&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;ami&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;templateId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;ami&quot;</span><span class="p">][</span><span class="s2">&quot;templateId&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;templateName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;ami&quot;</span><span class="p">][</span><span class="s2">&quot;templateName&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;iamRole&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;iamRole&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;roleInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;iamRole&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="k">if</span> <span class="s2">&quot;destComputerName&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;destComputerName&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;destComputerName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;destComputerName&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;destComputerUserName&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;destComputerUserName&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;destComputerUserName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;destComputerUserName&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;instanceAdminPassword&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;instanceAdminPassword&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;instanceAdminPassword&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;instanceAdminPassword&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disk_pattern</span><span class="o">.</span><span class="n">datastore</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;DestinationPath&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;DestinationPath&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;datastore&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;Datastore&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;datastore&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;block_level&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">[</span><span class="s2">&quot;blrRecoveryOpts&quot;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_blrRecoveryOpts</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="n">temp_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_advanced_option_restore_json</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">temp_dict</span>

    <span class="k">def</span> <span class="nf">_json_restore_blrRecoveryOpts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; setter for blr recovery options in block level json&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;recoveryType&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;recovery_type&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;granularV2&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;ccrpInterval&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ccrp_interval&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
                <span class="s2">&quot;acrpInterval&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;acrp_interval&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="s2">&quot;maxRpInterval&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_RpInterval&quot;</span><span class="p">,</span> <span class="mi">21600</span><span class="p">),</span>
                <span class="s2">&quot;rpMergeDelay&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rp_merge_delay&quot;</span><span class="p">,</span> <span class="mi">172800</span><span class="p">),</span>
                <span class="s2">&quot;rpRetention&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rp_retention&quot;</span><span class="p">,</span> <span class="mi">604800</span><span class="p">),</span>
                <span class="s2">&quot;maxRpStoreOfflineTime&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_RpStore_OfflineTime&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="s2">&quot;useOffPeakSchedule&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_OffPeak_Schedule&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="s2">&quot;rpStoreId&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rpstore_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="s2">&quot;rpStoreName&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rpstore_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_json_restore_volumeRstOption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;setter for  the Volume restore option for in restore json&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="k">return</span><span class="p">{</span>
            <span class="s2">&quot;destinationVendor&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_vendor&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">&quot;volumeLeveRestore&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;volumeLevelRestoreType&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;volume_level_restore&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">&quot;destinationDiskType&quot;</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;destination_disktype&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_get_vm_ids_and_names_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parses through the subclient content and creates 2 dictionaries.</span>

<span class="sd">            Returns:</span>
<span class="sd">                dict    -   dictionary consisting of VM ID as Key and VM</span>
<span class="sd">                            Display Name as value</span>

<span class="sd">                dict    -   dictionary consisting of VM Display Name as Key and</span>
<span class="sd">                            VM ID as value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vm_ids</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">vm_names</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">content</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;vm&#39;</span><span class="p">,</span> <span class="s1">&#39;virtual machine&#39;</span><span class="p">):</span>
                <span class="n">vm_ids</span><span class="p">[</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span>
                <span class="n">vm_names</span><span class="p">[</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">vm_ids</span><span class="p">,</span> <span class="n">vm_names</span>

    <span class="k">def</span> <span class="nf">_get_vm_ids_and_names_dict_from_browse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parses through the Browse content and get the VMs Backed up</span>

<span class="sd">            returns :</span>
<span class="sd">                vm_names    (list)  -- returns list of VMs backed up</span>
<span class="sd">                vm_ids      (dict)  -- returns id list of VMs backed up</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_vm_ids</span><span class="p">,</span> <span class="n">_vm_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_ids_and_names_dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vm_names_browse</span><span class="p">:</span>
            <span class="n">paths</span><span class="p">,</span> <span class="n">paths_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browse</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_vm_names</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">paths_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">_vm_names</span><span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="s1">&#39;snap_display_name&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">_each_path</span> <span class="ow">in</span> <span class="n">paths_dict</span><span class="p">:</span>
                <span class="n">_vm_id</span> <span class="o">=</span> <span class="n">_each_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vm_names_browse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_vm_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vm_ids_browse</span><span class="p">[</span><span class="n">_vm_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">_vm_names</span><span class="p">[</span><span class="n">_vm_id</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vm_names_browse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vm_ids_browse</span>

    <span class="k">def</span> <span class="nf">_parse_vm_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_names</span><span class="p">,</span> <span class="n">vm_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parses the path provided by user, and replaces the VM Display Name</span>
<span class="sd">           with the VM ID.</span>

<span class="sd">            Returns:</span>
<span class="sd">                str     -   string of path to run browse for</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">vm_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">vm_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">vm_path</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">vm_path</span>

            <span class="n">vm_path_list</span> <span class="o">=</span> <span class="n">vm_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">vm_name</span> <span class="ow">in</span> <span class="n">vm_names</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">vm_name</span> <span class="ow">in</span> <span class="n">vm_path_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">vm_path</span> <span class="o">=</span> <span class="n">vm_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">vm_path_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vm_names</span><span class="p">[</span><span class="n">vm_name</span><span class="p">])</span>
                    <span class="k">break</span>

        <span class="k">return</span> <span class="n">vm_path</span>

    <span class="k">def</span> <span class="nf">_process_vsa_browse_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_ids</span><span class="p">,</span> <span class="n">browse_content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Processes the Browse response and replaces the VM ID with their</span>
<span class="sd">        display name before returning to user.</span>

<span class="sd">            Args:</span>
<span class="sd">                vm_ids          (dict)      --  dictionary with VM ID as Key</span>
<span class="sd">                                                and VM Name as value</span>

<span class="sd">                browse_content  (tuple)     --  browse response received from</span>
<span class="sd">                                                server</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of all folders or files with their full</span>
<span class="sd">                       paths inside the input path</span>

<span class="sd">                dict - path along with the details like name, file/folder,</span>
<span class="sd">                       size, modification time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">browse_content</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">vm_ids</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">vm_id</span> <span class="ow">in</span> <span class="n">vm_ids</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">vm_id</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
                        <span class="n">browse_content</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">vm_id</span><span class="p">,</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_id</span><span class="p">])</span>

        <span class="n">temp_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">vm_ids</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">vm_id</span> <span class="ow">in</span> <span class="n">vm_ids</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">vm_id</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
                        <span class="n">temp_dict</span><span class="p">[</span><span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">vm_id</span><span class="p">,</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_id</span><span class="p">])]</span> <span class="o">=</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">path</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">temp_dict</span>

    <span class="k">def</span> <span class="nf">_process_restore_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_names</span><span class="p">,</span> <span class="n">restore_content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Processes the Restore Request and replaces the VM display name with</span>
<span class="sd">           their ID before passing to the API.</span>

<span class="sd">            Args:</span>
<span class="sd">                vm_names            (dict)      --  dictionary with VM Name as</span>
<span class="sd">                                                    Key, VM ID as value</span>

<span class="sd">                restore_content     (tuple)    --  content to restore specified</span>
<span class="sd">                                                   by user</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of all folders or files with their full paths</span>
<span class="sd">                       inside the input path</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">restore_content</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">vm_names</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">vm_name</span> <span class="ow">in</span> <span class="n">vm_names</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">vm_name</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
                        <span class="n">restore_content</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">vm_name</span><span class="p">,</span> <span class="n">vm_names</span><span class="p">[</span><span class="n">vm_name</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">restore_content</span>

<div class="viewcode-block" id="VirtualServerSubclient.browse"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.browse">[docs]</a>    <span class="k">def</span> <span class="nf">browse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_path</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span>
               <span class="n">show_deleted_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">vm_disk_browse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">vm_files_browse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the content of the backup for this subclient at the path</span>
<span class="sd">           specified.</span>

<span class="sd">            Args:</span>
<span class="sd">                vm_path             (str)   --  vm path to get the contents of</span>
<span class="sd">                                                default: &#39;\\&#39;;</span>
<span class="sd">                                                returns the root of the Backup</span>
<span class="sd">                                                content</span>

<span class="sd">                show_deleted_files  (bool)  --  include deleted files in the</span>
<span class="sd">                                                content or not default: False</span>

<span class="sd">                vm_disk_browse      (bool)  --  browse virtual machine files</span>
<span class="sd">                                                e.g.; .vmdk files, etc.</span>
<span class="sd">                                                only applicable when browsing</span>
<span class="sd">                                                content inside a guest virtual</span>
<span class="sd">                                                machine</span>
<span class="sd">                                                default: False</span>

<span class="sd">                vm_files_browse      (bool)  -- browse files and folders</span>
<span class="sd">                                                default: True</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of all folders or files with their full paths</span>
<span class="sd">                       inside the input path</span>

<span class="sd">                dict - path along with the details like name, file/folder,</span>
<span class="sd">                       size, modification time</span>

<span class="sd">            Raises:</span>
<span class="sd">                SDKException:</span>
<span class="sd">                    if failed to browse content</span>

<span class="sd">                    if response is empty</span>

<span class="sd">                    if response is not success</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vm_ids</span><span class="p">,</span> <span class="n">vm_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_ids_and_names_dict</span><span class="p">()</span>

        <span class="n">vm_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_vm_path</span><span class="p">(</span><span class="n">vm_names</span><span class="p">,</span> <span class="n">vm_path</span><span class="p">)</span>

        <span class="n">browse_content</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VirtualServerSubclient</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span>
            <span class="n">vm_path</span><span class="p">,</span> <span class="n">show_deleted_files</span><span class="p">,</span> <span class="n">vm_disk_browse</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">vs_file_browse</span><span class="o">=</span><span class="n">vm_files_browse</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vm_ids</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">vm_ids</span><span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;snap_display_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_vsa_browse_response</span><span class="p">(</span><span class="n">vm_ids</span><span class="p">,</span> <span class="n">browse_content</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualServerSubclient.parse_nics_xml"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.parse_nics_xml">[docs]</a>    <span class="k">def</span> <span class="nf">parse_nics_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_xml</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Gets the content of the backup for this subclient at the path</span>
<span class="sd">            specified.</span>

<span class="sd">            Args:</span>
<span class="sd">                input_xml : --   nics info xml per vm to parse the nics name</span>
<span class="sd">                                 and label</span>

<span class="sd">            Returns:</span>
<span class="sd">                nic_list:   --    list of all Nics for a VM</span>

<span class="sd">            Raise:</span>
<span class="sd">                SDKException:</span>
<span class="sd">                    if input parameter is not proper</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_xml</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s2">&quot;Subclient&quot;</span><span class="p">,</span> <span class="s2">&quot;101&quot;</span><span class="p">)</span>

        <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">input_xml</span><span class="p">)</span>

        <span class="n">nic_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">nic</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;nic&#39;</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">nic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">nic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
            <span class="n">subnet</span> <span class="o">=</span> <span class="n">nic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subnet&#39;</span><span class="p">)</span>
            <span class="n">networkDisplayName</span> <span class="o">=</span> <span class="n">nic</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;networkDisplayName&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="n">nic_info</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span>
                <span class="s1">&#39;subnetId&#39;</span><span class="p">:</span> <span class="n">subnet</span><span class="p">,</span>
                <span class="s1">&#39;networkDisplayName&#39;</span><span class="p">:</span> <span class="n">networkDisplayName</span>
            <span class="p">}</span>
            <span class="n">nic_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nic_info</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nic_list</span></div>

<div class="viewcode-block" id="VirtualServerSubclient.get_nics_from_browse"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.get_nics_from_browse">[docs]</a>    <span class="k">def</span> <span class="nf">get_nics_from_browse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Browses the vm to get the nics info xml, gets the nics info using</span>
<span class="sd">            the parse_nics_xml method and prepares the dict for nics json</span>


<span class="sd">            Returns:</span>
<span class="sd">                dict:   --   dict with key as vm_name and the value as the</span>
<span class="sd">                             nics info for that vm</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">path</span><span class="p">,</span> <span class="n">path_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="n">vm_disk_browse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">nics_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nics</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">vmpath</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">path_dict</span><span class="p">[</span><span class="n">vmpath</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;advanced_data&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">advanced_data</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;advanced_data&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="s1">&#39;browseMetaData&#39;</span> <span class="ow">in</span> <span class="n">advanced_data</span><span class="p">:</span>
                    <span class="n">browse_meta_data</span> <span class="o">=</span> <span class="n">advanced_data</span><span class="p">[</span><span class="s1">&#39;browseMetaData&#39;</span><span class="p">]</span>

                    <span class="k">if</span> <span class="s1">&#39;virtualServerMetaData&#39;</span> <span class="ow">in</span> <span class="n">browse_meta_data</span><span class="p">:</span>
                        <span class="n">virtual_server_metadata</span> <span class="o">=</span> <span class="n">browse_meta_data</span><span class="p">[</span><span class="s1">&#39;virtualServerMetaData&#39;</span><span class="p">]</span>

                        <span class="k">if</span> <span class="s1">&#39;nics&#39;</span> <span class="ow">in</span> <span class="n">virtual_server_metadata</span><span class="p">:</span>
                            <span class="n">nics</span> <span class="o">=</span> <span class="n">virtual_server_metadata</span><span class="p">[</span><span class="s1">&#39;nics&#39;</span><span class="p">]</span>

            <span class="n">nics_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_nics_xml</span><span class="p">(</span><span class="n">nics</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nics_dict</span></div>

<div class="viewcode-block" id="VirtualServerSubclient.browse_in_time"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.browse_in_time">[docs]</a>    <span class="k">def</span> <span class="nf">browse_in_time</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">vm_path</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">show_deleted_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">restore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">vm_disk_browse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">from_date</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">to_date</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">copy_precedence</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">vm_files_browse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">media_agent</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the content of the backup for this subclient</span>
<span class="sd">                at the path specified in the time range specified.</span>

<span class="sd">                Args:</span>
<span class="sd">                    vm_path             (str)   --  folder path to get the</span>
<span class="sd">                                                    contents of</span>
<span class="sd">                                                    default: &#39;\\&#39;</span>
<span class="sd">                                                    returns the root of the</span>
<span class="sd">                                                    Backup content</span>

<span class="sd">                    show_deleted_files  (bool)  --  include deleted files in</span>
<span class="sd">                                                    the content or not</span>
<span class="sd">                                                    default: False</span>

<span class="sd">                    restore_index       (bool)  --  restore index if it is not</span>
<span class="sd">                                                    cached  default: True</span>

<span class="sd">                    vm_disk_browse      (bool)  --  browse the VM disks or not</span>
<span class="sd">                                                    default: False</span>

<span class="sd">                    from_date           (int)   --  date to get the contents</span>
<span class="sd">                                                    after</span>
<span class="sd">                                                    format: dd/MM/YYYY</span>
<span class="sd">                                                    gets contents from</span>
<span class="sd">                                                    01/01/1970 if not specified</span>
<span class="sd">                                                    default: 0</span>

<span class="sd">                    to_date             (int)  --   date to get the contents</span>
<span class="sd">                                                    before</span>
<span class="sd">                                                    format: dd/MM/YYYY</span>
<span class="sd">                                                    gets contents till current</span>
<span class="sd">                                                    day if not specified</span>
<span class="sd">                                                    default: 0</span>

<span class="sd">                    copy_precedence     (int)   --  copy precedence to be used</span>
<span class="sd">                                                    for browsing</span>

<span class="sd">                    media_agent         (str)   --  Browse MA via with Browse has to happen.</span>
<span class="sd">                                                    It can be MA different than Storage Policy MA</span>

<span class="sd">                Returns:</span>
<span class="sd">                    list - list of all folders or files with their full paths</span>
<span class="sd">                           inside the input path</span>

<span class="sd">                    dict - path along with the details like name, file/folder,</span>
<span class="sd">                           size, modification time</span>

<span class="sd">                Raises:</span>
<span class="sd">                    SDKException:</span>
<span class="sd">                        if from date value is incorrect</span>

<span class="sd">                        if to date value is incorrect</span>

<span class="sd">                        if to date is less than from date</span>

<span class="sd">                        if failed to browse content</span>

<span class="sd">                        if response is empty</span>

<span class="sd">                        if response is not success</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="n">vm_ids</span><span class="p">,</span> <span class="n">vm_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_ids_and_names_dict</span><span class="p">()</span>
        <span class="n">vm_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_vm_path</span><span class="p">(</span><span class="n">vm_names</span><span class="p">,</span> <span class="n">vm_path</span><span class="p">)</span>

        <span class="n">browse_content</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VirtualServerSubclient</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span>
            <span class="n">show_deleted</span><span class="o">=</span><span class="n">show_deleted_files</span><span class="p">,</span> <span class="n">restore_index</span><span class="o">=</span><span class="n">restore_index</span><span class="p">,</span>
            <span class="n">vm_disk_browse</span><span class="o">=</span><span class="n">vm_disk_browse</span><span class="p">,</span>
            <span class="n">from_time</span><span class="o">=</span><span class="n">from_date</span><span class="p">,</span> <span class="n">to_time</span><span class="o">=</span><span class="n">to_date</span><span class="p">,</span> <span class="n">copy_precedence</span><span class="o">=</span><span class="n">copy_precedence</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">vm_path</span><span class="p">,</span> <span class="n">vs_file_browse</span><span class="o">=</span><span class="n">vm_files_browse</span><span class="p">,</span> <span class="n">media_agent</span><span class="o">=</span><span class="n">media_agent</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vm_ids</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">vm_ids</span><span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;snap_display_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_vsa_browse_response</span><span class="p">(</span><span class="n">vm_ids</span><span class="p">,</span> <span class="n">browse_content</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualServerSubclient.disk_level_browse"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.disk_level_browse">[docs]</a>    <span class="k">def</span> <span class="nf">disk_level_browse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_path</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span>
                          <span class="n">show_deleted_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">restore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">from_date</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">to_date</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">copy_precedence</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Browses the Disks of a Virtual Machine.</span>

<span class="sd">            Args:</span>
<span class="sd">                vm_path             (str)   --  vm path to get the contents of</span>
<span class="sd">                    default: &#39;\\&#39;; returns the root of the Backup content</span>

<span class="sd">                show_deleted_files  (bool)  --  include deleted files in the</span>
<span class="sd">                                                content or not default: False</span>

<span class="sd">                restore_index  (bool)  --       Restore index or not.</span>
<span class="sd">                                                default: True</span>

<span class="sd">                from_date           (int)   --  date to get the contents after</span>
<span class="sd">                                                format: dd/MM/YYYY</span>
<span class="sd">                                                gets contents from 01/01/1970</span>
<span class="sd">                                                if not specified</span>
<span class="sd">                                                default: 0</span>

<span class="sd">                to_date             (int)  --  date to get the contents before</span>
<span class="sd">                                               format: dd/MM/YYYY</span>
<span class="sd">                                               gets contents till current day</span>
<span class="sd">                                               if not specified</span>
<span class="sd">                                               default: 0</span>

<span class="sd">                copy_precedence     (int)   --  copy precedence to be used</span>
<span class="sd">                                                    for browsing</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of all folders or files with their full paths</span>
<span class="sd">                       inside the input path</span>

<span class="sd">                dict - path along with the details like name, file/folder,</span>
<span class="sd">                       size, modification time</span>

<span class="sd">            Raises:</span>
<span class="sd">                SDKException:</span>
<span class="sd">                    if failed to browse content</span>

<span class="sd">                    if response is empty</span>

<span class="sd">                    if response is not success</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">browse_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browse_in_time</span><span class="p">(</span>
            <span class="n">vm_path</span><span class="p">,</span> <span class="n">show_deleted_files</span><span class="p">,</span> <span class="n">restore_index</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">from_date</span><span class="p">,</span> <span class="n">to_date</span><span class="p">,</span> <span class="n">copy_precedence</span>
        <span class="p">)</span>

        <span class="n">paths_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">Ext</span><span class="p">)</span> <span class="k">for</span> <span class="n">Ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskExtension</span><span class="p">):</span>
                <span class="n">paths_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="s2">&quot;none&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskExtension</span><span class="p">:</span>
                <span class="n">paths_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="n">paths_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">Ext</span><span class="p">)</span> <span class="k">for</span> <span class="n">Ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskExtension</span><span class="p">):</span>
                <span class="n">paths_dict</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="o">=</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">path</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="s2">&quot;none&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskExtension</span><span class="p">:</span>
                <span class="c1"># assuming it as Fusion compute kind of hypervisors</span>
                <span class="n">paths_dict</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="o">=</span> <span class="n">browse_content</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">path</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">paths_list</span> <span class="ow">and</span> <span class="n">paths_dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">paths_list</span><span class="p">,</span> <span class="n">paths_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;113&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualServerSubclient.guest_files_browse"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.guest_files_browse">[docs]</a>    <span class="k">def</span> <span class="nf">guest_files_browse</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">vm_path</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">show_deleted_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">restore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">from_date</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">to_date</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">copy_precedence</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">media_agent</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Browses the Files and Folders inside a Virtual Machine in the time</span>
<span class="sd">           range specified.</span>

<span class="sd">            Args:</span>
<span class="sd">                vm_path             (str)   --  folder path to get the contents</span>
<span class="sd">                                                of</span>
<span class="sd">                                                default: &#39;\\&#39;;</span>
<span class="sd">                                                returns the root of the Backup</span>
<span class="sd">                                                content</span>

<span class="sd">                show_deleted_files  (bool)  --  include deleted files in the</span>
<span class="sd">                                                content or not default: False</span>

<span class="sd">                restore_index       (bool)  --  restore index if it is not cached</span>
<span class="sd">                                                default: True</span>

<span class="sd">                from_date           (int)   --  date to get the contents after</span>
<span class="sd">                                                format: dd/MM/YYYY</span>

<span class="sd">                                                gets contents from 01/01/1970</span>
<span class="sd">                                                if not specified</span>
<span class="sd">                                                default: 0</span>

<span class="sd">                to_date             (int)  --  date to get the contents before</span>
<span class="sd">                                               format: dd/MM/YYYY</span>

<span class="sd">                                               gets contents till current day</span>
<span class="sd">                                               if not specified</span>
<span class="sd">                                               default: 0</span>

<span class="sd">                copy_precedence     (int)   --  copy precedence to be used</span>
<span class="sd">                                                    for browsing</span>

<span class="sd">                media_agent         (str)   --  Browse MA via with Browse has to happen.</span>
<span class="sd">                                                It can be MA different than Storage Policy MA</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of all folders or files with their full paths</span>
<span class="sd">                       inside the input path</span>

<span class="sd">                dict - path along with the details like name, file/folder,</span>
<span class="sd">                       size, modification time</span>

<span class="sd">            Raises:</span>
<span class="sd">                SDKException:</span>
<span class="sd">                    if from date value is incorrect</span>

<span class="sd">                    if to date value is incorrect</span>

<span class="sd">                    if to date is less than from date</span>

<span class="sd">                    if failed to browse content</span>

<span class="sd">                    if response is empty</span>

<span class="sd">                    if response is not success</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">browse_in_time</span><span class="p">(</span>
            <span class="n">vm_path</span><span class="p">,</span> <span class="n">show_deleted_files</span><span class="p">,</span> <span class="n">restore_index</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">from_date</span><span class="p">,</span> <span class="n">to_date</span><span class="p">,</span> <span class="n">copy_precedence</span><span class="p">,</span>
            <span class="n">vm_files_browse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">media_agent</span><span class="o">=</span><span class="n">media_agent</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_folder_in_browse</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">_vm_id</span><span class="p">,</span>
            <span class="n">_folder_to_restore</span><span class="p">,</span>
            <span class="n">from_date</span><span class="p">,</span>
            <span class="n">to_date</span><span class="p">,</span>
            <span class="n">copy_precedence</span><span class="p">,</span>
            <span class="n">media_agent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the particular folder is present in browse of the subclient</span>
<span class="sd">        in particular VM</span>

<span class="sd">        args:</span>
<span class="sd">            _vm_id      (str)     -- VM id from which folder has to be restored</span>

<span class="sd">            _folder_to_restore (str)     -- folder path which has to be restored</span>

<span class="sd">            from_date           (int)   --  date to get the contents after</span>
<span class="sd">                                                format: dd/MM/YYYY</span>

<span class="sd">                                                gets contents from 01/01/1970</span>
<span class="sd">                                                if not specified</span>
<span class="sd">                                                default: 0</span>

<span class="sd">            to_date             (int)  --  date to get the contents before</span>
<span class="sd">                                               format: dd/MM/YYYY</span>

<span class="sd">                                               gets contents till current day</span>
<span class="sd">                                               if not specified</span>
<span class="sd">                                               default: 0</span>

<span class="sd">            copy_precedence     (int)   --  copy precedence to be used</span>
<span class="sd">                                                    for browsing</span>

<span class="sd">            media_agent         (str)   --  Browse MA via with Browse has to hapeen .</span>
<span class="sd">                                                    It can be MA different than Storage Policy MA</span>

<span class="sd">        exception:</span>
<span class="sd">            raise exception</span>
<span class="sd">                if folder is not present in browse</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">source_item</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">_folder_to_restore</span> <span class="o">=</span> <span class="n">_folder_to_restore</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">_restore_folder_name</span> <span class="o">=</span> <span class="n">_folder_to_restore</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">_folder_to_restore</span> <span class="o">=</span> <span class="n">_folder_to_restore</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">_restore_folder_name</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">_source_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_vm_id</span><span class="p">,</span> <span class="n">_folder_to_restore</span><span class="p">])</span>

        <span class="n">_browse_files</span><span class="p">,</span> <span class="n">_browse_files_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guest_files_browse</span><span class="p">(</span>
            <span class="n">_source_path</span><span class="p">,</span> <span class="n">from_date</span><span class="o">=</span><span class="n">from_date</span><span class="p">,</span> <span class="n">to_date</span><span class="o">=</span><span class="n">to_date</span><span class="p">,</span>
            <span class="n">copy_precedence</span><span class="o">=</span><span class="n">copy_precedence</span><span class="p">,</span> <span class="n">media_agent</span><span class="o">=</span><span class="n">media_agent</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">_path</span> <span class="ow">in</span> <span class="n">_browse_files_dict</span><span class="p">:</span>
            <span class="n">_browse_folder_name</span> <span class="o">=</span> <span class="n">_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">_browse_folder_name</span> <span class="o">==</span> <span class="n">_restore_folder_name</span><span class="p">:</span>
                <span class="n">source_item</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_source_path</span><span class="p">,</span> <span class="n">_restore_folder_name</span><span class="p">])</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">source_item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;102&#39;</span><span class="p">,</span> <span class="s1">&#39;Browse failure: Folder not found in browse&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">source_item</span>

<div class="viewcode-block" id="VirtualServerSubclient.guest_file_restore"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.guest_file_restore">[docs]</a>    <span class="k">def</span> <span class="nf">guest_file_restore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;perform Guest file restore of the provided path</span>

<span class="sd">        Args:</span>
<span class="sd">            options     (dict)  --  dictionary of guest file restores options</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">args</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="n">vm_name</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vm_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">folder_to_restore</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;folder_to_restore&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">destination_client</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;destination_client&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">destination_path</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;destination_path&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">copy_precedence</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;copy_precedence&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">preserve_level</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;preserve_level&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">unconditional_overwrite</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unconditional_overwrite&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">restore_ACL</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;restore_ACL&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">from_date</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;from_date&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">to_date</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;to_date&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">show_deleted_files</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_deleted_files&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">fbr_ma</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fbr_ma&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">browse_ma</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;browse_ma&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">agentless</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agentless&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">_vm_names</span><span class="p">,</span> <span class="n">_vm_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_ids_and_names_dict_from_browse</span><span class="p">()</span>
        <span class="n">_file_restore_option</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># check if inputs are correct</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">destination_path</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span> <span class="ow">and</span>
               <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">vm_name</span><span class="p">,</span> <span class="n">basestring</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;105&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vm_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_vm_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">)</span>

        <span class="c1"># check if client name is correct</span>
        <span class="k">if</span> <span class="n">destination_client</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">destination_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">co_ordinator</span>

        <span class="k">if</span> <span class="n">fbr_ma</span><span class="p">:</span>
            <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;proxy_client&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fbr_ma</span>

        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">destination_client</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;destination_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">destination_path</span>

        <span class="c1"># process the folder to restore for browse</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">folder_to_restore</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">_folder_to_restore_list</span> <span class="o">=</span> <span class="n">folder_to_restore</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">folder_to_restore</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="n">_folder_to_restore_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">_folder_to_restore_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">folder_to_restore</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;105&#39;</span><span class="p">)</span>

        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;paths&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_each_folder</span> <span class="ow">in</span> <span class="n">_folder_to_restore_list</span><span class="p">:</span>
            <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;paths&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_check_folder_in_browse</span><span class="p">(</span><span class="n">_vm_ids</span><span class="p">[</span><span class="n">vm_name</span><span class="p">],</span>
                                             <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">_each_folder</span><span class="p">,</span>
                                             <span class="n">from_date</span><span class="p">,</span>
                                             <span class="n">to_date</span><span class="p">,</span>
                                             <span class="n">copy_precedence</span><span class="p">,</span>
                                             <span class="n">media_agent</span><span class="o">=</span><span class="n">browse_ma</span><span class="p">))</span>

        <span class="c1"># set the browse options</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;disk_browse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;file_browse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># set the common file level restore options</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;striplevel_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PRESERVE_LEVEL&quot;</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;preserve_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">preserve_level</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;unconditional_overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unconditional_overwrite</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;restore_ACL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">restore_ACL</span>

        <span class="c1"># set the browse option</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;copy_precedence_applicable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;copy_precedence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy_precedence</span>
        <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;media_agent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">browse_ma</span>

        <span class="c1"># set agentless options</span>
        <span class="k">if</span> <span class="n">agentless</span><span class="p">:</span>
            <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;server_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agentless</span><span class="p">[</span><span class="s1">&#39;vserver&#39;</span><span class="p">]</span>
            <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;vm_guid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agentless</span><span class="p">[</span><span class="s1">&#39;vm_guid&#39;</span><span class="p">]</span>
            <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;vm_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agentless</span><span class="p">[</span><span class="s1">&#39;vm_name&#39;</span><span class="p">]</span>
            <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;user_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agentless</span><span class="p">[</span><span class="s1">&#39;vm_user&#39;</span><span class="p">]</span>
            <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agentless</span><span class="p">[</span><span class="s1">&#39;vm_pass&#39;</span><span class="p">]</span>
            <span class="n">_file_restore_option</span><span class="p">[</span><span class="s2">&quot;agentless&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># prepare and execute the Json</span>
        <span class="n">request_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_filelevel_restore_json</span><span class="p">(</span><span class="n">_file_restore_option</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_restore_response</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualServerSubclient.vm_files_browse"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.vm_files_browse">[docs]</a>    <span class="k">def</span> <span class="nf">vm_files_browse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_path</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">show_deleted_files</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Browses the Files and Folders of a Virtual Machine.</span>

<span class="sd">            Args:</span>
<span class="sd">                vm_path             (str)   --  vm path to get the contents of</span>
<span class="sd">                                                default: &#39;\\&#39;;</span>
<span class="sd">                                                returns the root of the Backup</span>
<span class="sd">                                                content</span>

<span class="sd">                show_deleted_files  (bool)  --  include deleted files in the</span>
<span class="sd">                                                content or not</span>
<span class="sd">                                                default: False</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of all folders or files with their full paths</span>
<span class="sd">                       inside the input path</span>

<span class="sd">                dict - path along with the details like name, file/folder,</span>
<span class="sd">                       size, modification time</span>

<span class="sd">            Raises:</span>
<span class="sd">                SDKException:</span>
<span class="sd">                    if failed to browse content</span>

<span class="sd">                    if response is empty</span>

<span class="sd">                    if response is not success</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="n">vm_path</span><span class="p">,</span> <span class="n">show_deleted_files</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualServerSubclient.vm_files_browse_in_time"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.vm_files_browse_in_time">[docs]</a>    <span class="k">def</span> <span class="nf">vm_files_browse_in_time</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">vm_path</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">show_deleted_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">restore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">from_date</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">to_date</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Browses the Files and Folders of a Virtual Machine in the time range</span>
<span class="sd">           specified.</span>

<span class="sd">            Args:</span>
<span class="sd">                vm_path             (basestring)   --  folder path to get the contents</span>
<span class="sd">                                                default: &#39;\\&#39;;</span>
<span class="sd">                                                returns the root of the Backup</span>
<span class="sd">                                                content</span>

<span class="sd">                show_deleted_files  (bool)  --  include deleted files in the</span>
<span class="sd">                                                content or not</span>
<span class="sd">                                                default: False</span>

<span class="sd">                restore_index       (bool)  --  restore index if it is not</span>
<span class="sd">                                                cached</span>
<span class="sd">                                                default: True</span>

<span class="sd">                from_date           (int)   --  date to get the contents after</span>
<span class="sd">                                                format: dd/MM/YYYY</span>
<span class="sd">                                                gets contents from 01/01/1970</span>
<span class="sd">                                                if not specified</span>
<span class="sd">                                                default: 0</span>

<span class="sd">                to_date             (int)  --   date to get the contents before</span>
<span class="sd">                                                format: dd/MM/YYYY</span>
<span class="sd">                                                gets contents till current day</span>
<span class="sd">                                                if not specified</span>
<span class="sd">                                                default: 0</span>

<span class="sd">            Returns:</span>
<span class="sd">                list - list of all folders or files with their full paths</span>
<span class="sd">                       inside the input path</span>

<span class="sd">                dict - path along with the details like name, file/folder,</span>
<span class="sd">                       size, modification time</span>

<span class="sd">            Raises:</span>
<span class="sd">                SDKException:</span>
<span class="sd">                    if from date value is incorrect</span>

<span class="sd">                    if to date value is incorrect</span>

<span class="sd">                    if to date is less than from date</span>

<span class="sd">                    if failed to browse content</span>

<span class="sd">                    if response is empty</span>

<span class="sd">                    if response is not success</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">browse_in_time</span><span class="p">(</span>
            <span class="n">vm_path</span><span class="p">,</span> <span class="n">show_deleted_files</span><span class="p">,</span> <span class="n">restore_index</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">from_date</span><span class="p">,</span> <span class="n">to_date</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_disk_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">disk_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the Extension of all disk in the list</span>

<span class="sd">        Args:</span>
<span class="sd">            disk_list   (LIST)  -- get the disk List</span>

<span class="sd">        return:</span>
<span class="sd">            extn_list   (LIST)  --  returns the Extension List of the disk list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_extn_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_disk</span> <span class="ow">in</span> <span class="n">disk_list</span><span class="p">:</span>
            <span class="n">_disk_name</span><span class="p">,</span> <span class="n">_extn_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">each_disk</span><span class="p">)</span>
            <span class="n">_extn_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_extn_name</span><span class="p">)</span>

        <span class="n">_extn_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_extn_list</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_extn_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_extn_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_extn_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_conversion_disk_Type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_src_disk_extn</span><span class="p">,</span> <span class="n">_dest_disk_extn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return volume restore type and destination disk Type</span>

<span class="sd">        Args:</span>
<span class="sd">            src_disk_extn   (basestring)   --  source disk extension of the disk</span>
<span class="sd">            dest_disk_extn  (basestring)   --  Extension to which disk is converted</span>

<span class="sd">        return</span>
<span class="sd">            _vol_restore_type   (basestring)   -- value of Volume restore type</span>
<span class="sd">                                           parameter of the XML</span>
<span class="sd">            _dest_disk_type     (basestring)   -- value of destination Disk Type</span>
<span class="sd">                                           parameter of the XML</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">disk_conversion</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;vhdx&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;vhd&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;VIRTUAL_HARD_DISKS&quot;</span><span class="p">,</span> <span class="s2">&quot;VHD_DYNAMIC&quot;</span><span class="p">),</span>
                <span class="s2">&quot;vmdk&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;VMDK_FILES&quot;</span><span class="p">,</span> <span class="s2">&quot;VMDK_VCB4&quot;</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="s2">&quot;vmdk&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;vhd&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;VIRTUAL_HARD_DISKS&quot;</span><span class="p">,</span> <span class="s2">&quot;VHD_DYNAMIC&quot;</span><span class="p">),</span>
                <span class="s2">&quot;vhdx&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;VIRTUAL_HARD_DISKS&quot;</span><span class="p">,</span> <span class="s2">&quot;VHDX_DYNAMIC&quot;</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">_src_disk_extn</span> <span class="o">=</span> <span class="n">_src_disk_extn</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="n">_dest_disk_extn</span> <span class="o">=</span> <span class="n">_dest_disk_extn</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">disk_conversion</span><span class="p">[</span><span class="n">_src_disk_extn</span><span class="p">][</span><span class="n">_dest_disk_extn</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_set_vm_to_restore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_to_restore</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restore_option</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        check whether the VMs provided for restore is backued up else assume</span>
<span class="sd">                            Vm_to_restore with default</span>

<span class="sd">        Args:</span>
<span class="sd">            vm_to_restore   (list)      -- list of Vm to restore</span>

<span class="sd">            restore_option  (dict)      -- dict with all restore options</span>

<span class="sd">        return:</span>
<span class="sd">            vm_to_restore   (list)      -- Final list of Vm need to be restored</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">restore_option</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">restore_option</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vm_names_browse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_ids_and_names_dict_from_browse</span><span class="p">()</span>

        <span class="c1"># set vms to restore</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vm_to_restore</span><span class="p">:</span>
            <span class="n">vm_to_restore</span> <span class="o">=</span> <span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vm_to_restore&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vm_ids_browse</span><span class="p">)</span>
            <span class="n">_temp_res_list</span> <span class="o">=</span> <span class="n">vm_to_restore</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">_temp_res_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">each_vm</span> <span class="ow">in</span> <span class="n">vm_to_restore</span><span class="p">:</span>
                <span class="n">_temp_res_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">each_vm</span><span class="p">)</span>

        <span class="n">vm_to_restore</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vm_names_browse</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">_temp_res_list</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">vm_to_restore</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;104&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">vm_to_restore</span>

    <span class="k">def</span> <span class="nf">_set_restore_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set all the advanced properties of the subclient restore</span>

<span class="sd">        Args:</span>
<span class="sd">            restore_option  (dict)  -- restore option dictionary where advanced</span>
<span class="sd">                                            properties to be appended</span>

<span class="sd">            **kwargs                --  Keyword arguments with key as property name</span>
<span class="sd">                                            and its value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">or</span> <span class="n">restore_option</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">restore_option</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_subclient_proxies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the list of all the proxies on a selected subclient</span>

<span class="sd">        Returns:</span>
<span class="sd">            associated_proxies   (LIST)  --  returns the proxies list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">associated_proxies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">available_subclient_proxies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vsaSubclientProp</span><span class="p">[</span><span class="s2">&quot;proxies&quot;</span><span class="p">][</span><span class="s2">&quot;memberServers&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available_subclient_proxies</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">proxy</span> <span class="ow">in</span> <span class="n">available_subclient_proxies</span><span class="p">:</span>
                    <span class="n">associated_proxies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proxy</span><span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="p">][</span><span class="s2">&quot;clientName&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">associated_proxies</span>

    <span class="k">def</span> <span class="nf">_set_restore_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param restore_option:  dict with all restore input values</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="p">((</span><span class="s2">&quot;vcenter_client&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;vcenter_client&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">instance_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">]</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_client_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance_dict</span><span class="p">[</span><span class="s2">&quot;clientName&quot;</span><span class="p">]</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_instance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance_dict</span><span class="p">[</span><span class="s2">&quot;instanceName&quot;</span><span class="p">]</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commcell_object</span><span class="o">.</span><span class="n">clients</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;vcenter_client&quot;</span><span class="p">])</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_client_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;vcenter_client&quot;</span><span class="p">]</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_client_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">client_id</span><span class="p">)</span>
            <span class="n">agent</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Virtual Server&#39;</span><span class="p">)</span>
            <span class="n">instancekeys</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">_instances</span><span class="p">))</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">instancekeys</span><span class="p">)</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_instance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">instance_name</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_instance_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">instance_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">((</span><span class="s2">&quot;esx_server&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;esx_server&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;esx_server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">server_host_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">((</span><span class="s2">&quot;client_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;client_name&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">subclient_proxy_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_subclient_proxies</span><span class="p">()</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subclient_proxy_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subclient_proxy_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">co_ordinator</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;client_name&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_set_vm_conversion_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vcenter_client</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set all the VMconversion changews need to be performed</span>
<span class="sd">        Args:</span>
<span class="sd">            vcenter_client: Client Name to which it has to be converted</span>

<span class="sd">            restore_option: dictinoary where parameter needs to be set</span>

<span class="sd">        Returns:</span>
<span class="sd">            subclient :     (obj)   : object for the subclient class of virtual client</span>
<span class="sd">            raise exception:</span>
<span class="sd">             if client does not exist</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commcell_object</span><span class="o">.</span><span class="n">clients</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vcenter_client</span><span class="p">)</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Virtual Server&#39;</span><span class="p">)</span>
        <span class="n">instancekeys</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">_instances</span><span class="p">))</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">instancekeys</span><span class="p">)</span>
        <span class="n">backupsetkeys</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">backupsets</span><span class="o">.</span><span class="n">_backupsets</span><span class="p">))</span>
        <span class="n">backupset</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">backupsets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">backupsetkeys</span><span class="p">)</span>
        <span class="n">sckeys</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">backupset</span><span class="o">.</span><span class="n">subclients</span><span class="o">.</span><span class="n">_subclients</span><span class="p">))</span>
        <span class="n">subclient</span> <span class="o">=</span> <span class="n">backupset</span><span class="o">.</span><span class="n">subclients</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sckeys</span><span class="p">)</span>

        <span class="c1"># populating all defaults</span>
        <span class="n">esx_server</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">server_host_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disk_pattern</span> <span class="o">=</span> <span class="n">subclient</span><span class="o">.</span><span class="n">disk_pattern</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_vendor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">_vendor_id</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;backupset_client_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">client_name</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">subclient</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;104&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">subclient</span>

<div class="viewcode-block" id="VirtualServerSubclient.set_advanced_vm_restore_options"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.set_advanced_vm_restore_options">[docs]</a>    <span class="k">def</span> <span class="nf">set_advanced_vm_restore_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_to_restore</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the advanced restore options for all vm in restore</span>
<span class="sd">        :param</span>

<span class="sd">        vm_to_restore : Name of the VM to restore</span>
<span class="sd">        restore_option: restore options that need to be set for advanced restore option</span>

<span class="sd">            power_on                    - power on the VM after restore</span>
<span class="sd">            add_to_failover             - Register the VM to Failover Cluster</span>
<span class="sd">            datastore                   - Datastore where the VM needs to be restored</span>

<span class="sd">            disks   (list of dict)      - list with dict for each disk in VM</span>
<span class="sd">                                            eg: [{</span>
<span class="sd">                                                    name:&quot;disk1.vmdk&quot;</span>
<span class="sd">                                                    datastore:&quot;local&quot;</span>
<span class="sd">                                                }</span>
<span class="sd">                                                {</span>
<span class="sd">                                                    name:&quot;disk2.vmdk&quot;</span>
<span class="sd">                                                    datastore:&quot;local1&quot;</span>
<span class="sd">                                                }</span>
<span class="sd">                                            ]</span>
<span class="sd">            guid                        - GUID of the VM needs to be restored</span>
<span class="sd">            new_name                    - New name for the VM to be restored</span>
<span class="sd">            esx_host                    - esx_host or client name where it need to be restored</span>
<span class="sd">            name                        - name of the VM to be restored</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Set the new name for the restored VM.</span>
        <span class="c1"># If new_name is not given, it restores the VM with same name</span>
        <span class="c1"># with suffix Delete.</span>
        <span class="n">vm_names</span><span class="p">,</span> <span class="n">vm_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_ids_and_names_dict_from_browse</span><span class="p">()</span>
        <span class="n">browse_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vm_files_browse</span><span class="p">()</span>

        <span class="c1"># vs metadata from browse result</span>
        <span class="n">_metadata</span> <span class="o">=</span> <span class="n">browse_result</span><span class="p">[</span><span class="mi">1</span><span class="p">][(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">vm_to_restore</span><span class="p">)]</span>
        <span class="n">vs_metadata</span> <span class="o">=</span> <span class="n">_metadata</span><span class="p">[</span><span class="s2">&quot;advanced_data&quot;</span><span class="p">][</span><span class="s2">&quot;browseMetaData&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerMetaData&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;in_place&#39;</span><span class="p">]:</span>
            <span class="n">folder_path</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inventoryPath&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">instanceSize</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;instanceSize&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">folder_path</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">instanceSize</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;resourcePoolPath&#39;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;resourcePoolPath&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;resourcePoolPath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;resourcePoolPath&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;datacenter&#39;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;datacenter&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;datacenter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataCenter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;terminationProtected&#39;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span>
                <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;terminationProtected&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;terminationProtected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;terminationProtected&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;iamRole&#39;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;iamRole&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;iamRole&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;securityGroups&#39;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;securityGroups&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_security_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_security_groups</span><span class="p">(</span><span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;networkSecurityGroups&#39;</span><span class="p">])</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;securityGroups&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_security_groups</span>
        <span class="k">if</span> <span class="s1">&#39;keyPairList&#39;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;keyPairList&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_keypair_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_keypair_list</span><span class="p">(</span><span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;loginKeyPairs&#39;</span><span class="p">])</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;keyPairList&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_keypair_list</span>

        <span class="c1"># populate restore source item</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;paths&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_to_restore</span><span class="p">])</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_to_restore</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_to_restore</span><span class="p">]</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;FolderPath&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">folder_path</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;ResourcePool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>

        <span class="c1"># populate restore disk and datastore</span>
        <span class="n">vm_disks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">disk_list</span><span class="p">,</span> <span class="n">disk_info_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disk_level_browse</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_to_restore</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">disk</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">disk_info_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;datastore&quot;</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">:</span>
                <span class="n">ds</span> <span class="o">=</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;datastore&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;in_place&quot;</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;datastore&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;datastore&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;advanced_data&quot;</span><span class="p">][</span><span class="s2">&quot;browseMetaData&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerMetaData&quot;</span><span class="p">]:</span>
                    <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;datastore&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;advanced_data&quot;</span><span class="p">][</span><span class="s2">&quot;browseMetaData&quot;</span><span class="p">][</span>
                        <span class="s2">&quot;virtualServerMetaData&quot;</span><span class="p">][</span><span class="s2">&quot;datastore&quot;</span><span class="p">]</span>
                    <span class="n">ds</span> <span class="o">=</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;datastore&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;esxHost&quot;</span> <span class="ow">in</span> <span class="n">vs_metadata</span> <span class="ow">and</span> <span class="s2">&quot;is_aws_proxy&quot;</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;availability_zone&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ds</span> <span class="o">=</span> <span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;availability_zone&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ds</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s2">&quot;esxHost&quot;</span><span class="p">]</span>
            <span class="n">new_name_prefix</span> <span class="o">=</span> <span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disk_name_prefix&quot;</span><span class="p">)</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">new_name_prefix</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">new_name_prefix</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;destination_instance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;vmware&#39;</span><span class="p">:</span>
                <span class="n">_disk_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disk_dict_pattern</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;snap_display_name&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_disk_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disk_dict_pattern</span><span class="p">(</span><span class="n">disk</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ds</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;is_aws_proxy&#39;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;is_aws_proxy&#39;</span><span class="p">]:</span>
                <span class="n">_disk_dict</span><span class="p">[</span><span class="s1">&#39;Datastore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;datastore&quot;</span><span class="p">]</span>
            <span class="n">vm_disks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_disk_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vm_disks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;104&#39;</span><span class="p">)</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;disks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_disks</span>

        <span class="c1"># prepare nics info json</span>
        <span class="k">if</span> <span class="s2">&quot;nics&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">:</span>
            <span class="n">nics_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_nics_advancedRestoreOptions</span><span class="p">(</span><span class="n">vm_to_restore</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">)</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;nics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nics_list</span>
            <span class="k">if</span> <span class="s2">&quot;source_ip&quot;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span> <span class="s2">&quot;destination_ip&quot;</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;source_ip&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_ip&quot;</span><span class="p">]:</span>
                    <span class="n">vm_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_vmip_advanced_restore_options</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
                    <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;vm_ip_address_options&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_ip</span>
            <span class="k">if</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;in_place&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="s2">&quot;hyper&quot;</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_instance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;client_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;esxHost&#39;</span><span class="p">]</span>
                    <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;esx_server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;esxHost&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;Red&#39;</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_instance&quot;</span><span class="p">]:</span>
                    <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;esxHost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;clusterName&#39;</span><span class="p">]</span>
                    <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;clusterName&#39;</span><span class="p">]</span>
                    <span class="n">vs_metadata</span><span class="p">[</span><span class="s2">&quot;esxHost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;clusterName&#39;</span><span class="p">]</span>

        <span class="c1"># populate VM Specific values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_restore_inputs</span><span class="p">(</span>
            <span class="n">restore_option</span><span class="p">,</span>
            <span class="n">disks</span><span class="o">=</span><span class="n">vm_disks</span><span class="p">,</span>
            <span class="n">esx_host</span><span class="o">=</span><span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;esx_host&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;esxHost&#39;</span><span class="p">],</span>
            <span class="n">instanceSize</span><span class="o">=</span><span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;instanceSize&#39;</span><span class="p">,</span> <span class="n">instanceSize</span><span class="p">),</span>
            <span class="n">new_name</span><span class="o">=</span><span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;new_name&#39;</span><span class="p">,</span> <span class="s2">&quot;Delete&quot;</span> <span class="o">+</span> <span class="n">vm_to_restore</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">temp_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_advancedRestoreOptions</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dict</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualServerSubclient.set_advanced_attach_disk_restore_options"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.set_advanced_attach_disk_restore_options">[docs]</a>    <span class="k">def</span> <span class="nf">set_advanced_attach_disk_restore_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_to_restore</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the advanced restore options for all vm in restore</span>
<span class="sd">        :param</span>

<span class="sd">        vm_to_restore : Name of the VM where disks will be restored</span>
<span class="sd">        restore_option: restore options that need to be set for advanced restore option</span>

<span class="sd">            datastore                   - Datastore where the disks needs to be restored</span>

<span class="sd">            disks   (list of dict)      - list with dict for each disk in VM</span>
<span class="sd">                                            eg: [{</span>
<span class="sd">                                                    name:&quot;disk1.vmdk&quot;</span>
<span class="sd">                                                    datastore:&quot;local&quot;</span>
<span class="sd">                                                }</span>
<span class="sd">                                                {</span>
<span class="sd">                                                    name:&quot;disk2.vmdk&quot;</span>
<span class="sd">                                                    datastore:&quot;local1&quot;</span>
<span class="sd">                                                }</span>
<span class="sd">                                            ]</span>
<span class="sd">            guid                        - GUID of the VM needs to be restored</span>
<span class="sd">            new_name                    - New name for the VM to be restored</span>
<span class="sd">            esx_host                    - esx_host or client name where it need to be restored</span>
<span class="sd">            name                        - name of the VM to be restored</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Set the new name for the restored VM.</span>
        <span class="c1"># If new_name is not given, it restores the VM with same name</span>
        <span class="c1"># with suffix Delete.</span>
        <span class="n">vm_names</span><span class="p">,</span> <span class="n">vm_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_ids_and_names_dict_from_browse</span><span class="p">()</span>
        <span class="n">browse_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vm_files_browse</span><span class="p">()</span>
        <span class="c1"># populate restore source item</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_to_restore</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_to_restore</span><span class="p">]</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;FolderPath&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;ResourcePool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>

        <span class="c1"># populate restore disk and datastore</span>
        <span class="n">vm_disks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">disk_list</span><span class="p">,</span> <span class="n">disk_info_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disk_level_browse</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_to_restore</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">disk</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">disk_info_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;datastore&quot;</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">:</span>
                <span class="n">ds</span> <span class="o">=</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;datastore&quot;</span><span class="p">]</span>
            <span class="n">new_name_prefix</span> <span class="o">=</span> <span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disk_name_prefix&quot;</span><span class="p">)</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="s2">&quot;delete_&quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">new_name_prefix</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">new_name_prefix</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="n">_disk_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disk_dict_pattern</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;snap_display_name&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
            <span class="n">vm_disks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_disk_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vm_disks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;104&#39;</span><span class="p">)</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;disks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_disks</span>

        <span class="c1"># populate VM Specific values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_restore_inputs</span><span class="p">(</span>
            <span class="n">restore_option</span><span class="p">,</span>
            <span class="n">disks</span><span class="o">=</span><span class="n">vm_disks</span><span class="p">,</span>
            <span class="n">esx_host</span><span class="o">=</span><span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;esx&#39;</span><span class="p">),</span>
            <span class="n">new_name</span><span class="o">=</span><span class="n">vm_to_restore</span><span class="p">,</span>
            <span class="n">new_guid</span> <span class="o">=</span> <span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">),</span>
            <span class="n">Datastore</span><span class="o">=</span><span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;datastore&#39;</span><span class="p">))</span>

        <span class="n">temp_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_advancedRestoreOptions</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dict</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_find_security_groups</span><span class="p">(</span><span class="n">xml_str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the security group json from the input xml</span>
<span class="sd">        Args:</span>
<span class="sd">             xml_str            (str)  --  xml from which we want to retrieve security group info</span>
<span class="sd">        Returns:</span>
<span class="sd">             security_group    (dict)  -- security group dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">match1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;secGroupId=</span><span class="se">\&quot;</span><span class="s1">(\S*)</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">xml_str</span><span class="p">)</span>
        <span class="n">match2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;secGroupName=</span><span class="se">\&quot;</span><span class="s1">(\S*)</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">xml_str</span><span class="p">)</span>
        <span class="n">security_group</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;groupId&quot;</span><span class="p">:</span> <span class="n">match1</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                <span class="s2">&quot;groupName&quot;</span><span class="p">:</span> <span class="n">match2</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">security_group</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_find_keypair_list</span><span class="p">(</span><span class="n">xml_str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the keypair list json from the input xml</span>
<span class="sd">        Args:</span>
<span class="sd">             xml_str            (str)  --  xml from which we want to retrieve keypair list info</span>
<span class="sd">        Returns:</span>
<span class="sd">             keypair_list	(dict) -- keypair list dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">match1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;keyPairId=</span><span class="se">\&quot;</span><span class="s1">(\S*)</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">xml_str</span><span class="p">)</span>
        <span class="n">match2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;keyPairName=</span><span class="se">\&quot;</span><span class="s1">(\S*)</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">xml_str</span><span class="p">)</span>
        <span class="n">keypair_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;keyId&quot;</span><span class="p">:</span> <span class="n">match1</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                <span class="s2">&quot;keyName&quot;</span><span class="p">:</span> <span class="n">match2</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">keypair_list</span>

<div class="viewcode-block" id="VirtualServerSubclient.amazon_defaults"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.amazon_defaults">[docs]</a>    <span class="k">def</span> <span class="nf">amazon_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_to_restore</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               set all the VMconversion changes need to be performed</span>
<span class="sd">               specfic to Amazon</span>
<span class="sd">               Args:</span>
<span class="sd">                   vm_to_restore  (str)  :  content of destination subclient object</span>

<span class="sd">                   restore_option (dict) :  dictionary with all VM restore options</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">browse_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vm_files_browse</span><span class="p">()</span>

        <span class="c1"># vs metadata from browse result</span>
        <span class="n">_metadata</span> <span class="o">=</span> <span class="n">browse_result</span><span class="p">[</span><span class="mi">1</span><span class="p">][(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">vm_to_restore</span><span class="p">)]</span>
        <span class="n">vs_metadata</span> <span class="o">=</span> <span class="n">_metadata</span><span class="p">[</span><span class="s2">&quot;advanced_data&quot;</span><span class="p">][</span><span class="s2">&quot;browseMetaData&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerMetaData&quot;</span><span class="p">]</span>

        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;resourcePoolPath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;resourcePoolPath&#39;</span><span class="p">]</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;datacenter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dataCenter&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;terminationProtected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;terminationProtected&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;iamRole&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">_security_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_security_groups</span><span class="p">(</span><span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;networkSecurityGroups&#39;</span><span class="p">])</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;securityGroups&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_security_groups</span>
        <span class="n">_keypair_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_keypair_list</span><span class="p">(</span><span class="n">vs_metadata</span><span class="p">[</span><span class="s1">&#39;loginKeyPairs&#39;</span><span class="p">])</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;keyPairList&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_keypair_list</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;esx_host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;esxHost&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;datastore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vs_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;datastore&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">nics_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_nics_advancedRestoreOptions</span><span class="p">(</span><span class="n">vm_to_restore</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">)</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;nics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nics_list</span>

        <span class="k">return</span> <span class="n">restore_option</span></div>

    <span class="k">def</span> <span class="nf">_prepare_filelevel_restore_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_file_restore_option</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        prepares the  file level restore json from getters</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">_file_restore_option</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_file_restore_option</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># set the setters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">_restore_association</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subClientEntity</span>
        <span class="n">request_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_restore_json</span><span class="p">(</span><span class="n">restore_option</span><span class="o">=</span><span class="n">_file_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_virtualServerRstOption</span><span class="p">(</span><span class="n">_file_restore_option</span><span class="p">)</span>

        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span>
            <span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span>

        <span class="k">if</span> <span class="n">_file_restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agentless&#39;</span><span class="p">):</span>
            <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span>
                <span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerRstOption&quot;</span><span class="p">][</span>
                <span class="s2">&quot;fileLevelVMRestoreOption&quot;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_virtualServerRstOption_filelevelrestoreoption</span><span class="p">(</span><span class="n">_file_restore_option</span><span class="p">)</span>
            <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span>
                <span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerRstOption&quot;</span><span class="p">][</span><span class="s2">&quot;fileLevelVMRestoreOption&quot;</span><span class="p">][</span>
                <span class="s2">&quot;guestUserPassword&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_guest_password</span><span class="p">(</span><span class="n">_file_restore_option</span><span class="p">)</span>

        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span>
            <span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;volumeRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_volumeRstOption</span><span class="p">(</span><span class="n">_file_restore_option</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">request_json</span>

    <span class="k">def</span> <span class="nf">_prepare_disk_restore_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_disk_restore_option</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare disk retsore Json with all getters</span>

<span class="sd">        Args:</span>
<span class="sd">            _disk_restore_option - dictionary with all disk restore options</span>

<span class="sd">            value:</span>
<span class="sd">                preserve_level              -  set the preserve level in restore</span>
<span class="sd">                unconditional_overwrite     - unconditionally overwrite the disk</span>
<span class="sd">                                                    in the restore path</span>

<span class="sd">                destination_path            - path where the disk needs to be restored</span>
<span class="sd">                client_name                 - client where the disk needs to be restored</span>

<span class="sd">                destination_vendor          - vendor id of the Hypervisor</span>
<span class="sd">                destination_disktype        - type of disk needs to be restored like VHDX,VHD,VMDK</span>
<span class="sd">                paths                 - GUID of VM from which disk needs to be restored</span>
<span class="sd">                                                eg:\\5F9FA60C-0A89-4BD9-9D02-C5ACB42745EA</span>

<span class="sd">                copy_precedence_applicable  - True if needs copy_precedence to be honored else</span>
<span class="sd">                                                        False</span>

<span class="sd">                copy_precedence            - the copy id from which browse and</span>
<span class="sd">                                                                restore needs to be performed</span>

<span class="sd">        returns:</span>
<span class="sd">            request_json        -complete json for performing disk Restore options</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">_disk_restore_option</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_disk_restore_option</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># set the setters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">_restore_association</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subClientEntity</span>
        <span class="n">request_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_restore_json</span><span class="p">(</span><span class="n">restore_option</span><span class="o">=</span><span class="n">_disk_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_virtualServerRstOption</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_diskLevelVMRestoreOption</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">)</span>

        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span>
            <span class="s2">&quot;options&quot;</span><span class="p">][</span><span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span>

        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span>
            <span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;volumeRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_volumeRstOption</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">request_json</span>

    <span class="k">def</span> <span class="nf">_prepare_attach_disk_restore_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_disk_restore_option</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare attach disk retsore Json with all getters</span>

<span class="sd">        Args:</span>
<span class="sd">            _disk_restore_option - dictionary with all attach disk restore options</span>

<span class="sd">            value:</span>
<span class="sd">                destination_path            - path where the disk needs to be restored</span>

<span class="sd">                client_name                 - client where the disk needs to be restored</span>

<span class="sd">                destination_vendor          - vendor id of the Hypervisor</span>

<span class="sd">                paths                 - GUID of VM from which disk needs to be restored</span>
<span class="sd">                                                eg:\\5F9FA60C-0A89-4BD9-9D02-C5ACB42745EA</span>

<span class="sd">                copy_precedence_applicable  - True if needs copy_precedence to be honored else</span>
<span class="sd">                                                        False</span>

<span class="sd">                copy_precedence            - the copy id from which browse and</span>
<span class="sd">                                                                restore needs to be performed</span>

<span class="sd">        returns:</span>
<span class="sd">            request_json        -complete json for performing disk Restore options</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">_disk_restore_option</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_disk_restore_option</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># set the setters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">_restore_association</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subClientEntity</span>
        <span class="n">request_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_restore_json</span><span class="p">(</span><span class="n">restore_option</span><span class="o">=</span><span class="n">_disk_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_restore_defaults</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_virtualServerRstOption</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_vcenter_instance</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_attach_diskLevelVMRestoreOption</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_advanced_attach_disk_restore_options</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">[</span><span class="s1">&#39;vm_to_restore&#39;</span><span class="p">],</span><span class="n">_disk_restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;diskLevelVMRestoreOption&quot;</span><span class="p">][</span>
            <span class="s2">&quot;advancedRestoreOptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span><span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span>
            <span class="s2">&quot;virtualServerRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span>
            <span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;volumeRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_volumeRstOption</span><span class="p">(</span><span class="n">_disk_restore_option</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">request_json</span>

    <span class="k">def</span> <span class="nf">_prepare_fullvm_restore_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restore_option</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare Full VM restore Json with all getters</span>

<span class="sd">        Args:</span>
<span class="sd">            restore_option - dictionary with all VM restore options</span>

<span class="sd">        value:</span>
<span class="sd">            preserve_level              - set the preserve level in restore</span>

<span class="sd">            unconditional_overwrite     - unconditionally overwrite the disk</span>
<span class="sd">                                          in the restore path</span>

<span class="sd">            destination_path            - path where the disk needs to be</span>
<span class="sd">                                          restored</span>

<span class="sd">            client_name                 - client where the disk needs to be</span>
<span class="sd">                                          restored</span>

<span class="sd">            destination_vendor          - vendor id of the Hypervisor</span>

<span class="sd">            destination_disktype        - type of disk needs to be restored</span>
<span class="sd">                                          like VHDX,VHD,VMDK</span>

<span class="sd">            source_item                 - GUID of VM from which disk needs to</span>
<span class="sd">                                          be restored</span>
<span class="sd">                                          eg:</span>
<span class="sd">                                          \\5F9FA60C-0A89-4BD9-9D02-C5ACB42745EA</span>

<span class="sd">            copy_precedence_applicable  - True if needs copy_precedence to</span>
<span class="sd">                                          be honoured else False</span>

<span class="sd">            copy_precedence            - the copy id from which browse and</span>
<span class="sd">                                          restore needs to be performed</span>

<span class="sd">            power_on                    - power on the VM after restore</span>

<span class="sd">            add_to_failover             - Register the VM to Failover Cluster</span>

<span class="sd">            datastore                   - Datastore where the VM needs to be</span>
<span class="sd">                                          restored</span>

<span class="sd">            disks   (list of dict)      - list with dict for each disk in VM</span>
<span class="sd">                                            eg: [{</span>
<span class="sd">                                                    name:&quot;disk1.vmdk&quot;</span>
<span class="sd">                                                    datastore:&quot;local&quot;</span>
<span class="sd">                                                }</span>
<span class="sd">                                                {</span>
<span class="sd">                                                    name:&quot;disk2.vmdk&quot;</span>
<span class="sd">                                                    datastore:&quot;local1&quot;</span>
<span class="sd">                                                }</span>
<span class="sd">                                            ]</span>
<span class="sd">            guid                        - GUID of the VM needs to be restored</span>
<span class="sd">            new_name                    - New name for the VM to be restored</span>
<span class="sd">            esx_host                    - esx_host or client name where it need</span>
<span class="sd">                                          to be restored</span>
<span class="sd">            name                        - name of the VM to be restored</span>

<span class="sd">        returns:</span>
<span class="sd">              request_json        -complete json for perfomring Full VM Restore</span>
<span class="sd">                                   options</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">restore_option</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">restore_option</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;paths&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="s2">&quot;destination_vendor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">:</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_vendor&quot;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">_vendor_id</span>

        <span class="k">if</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;copy_precedence&#39;</span><span class="p">]:</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;copy_precedence_applicable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># set all the restore defaults</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_restore_defaults</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>

        <span class="c1"># set the setters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">_restore_association</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subClientEntity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_virtualServerRstOption</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_diskLevelVMRestoreOption</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_vcenter_instance</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">_each_vm_to_restore</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;vm_to_restore&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;in_place&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;restore_new_name&quot;</span> <span class="ow">in</span> <span class="n">restore_option</span> <span class="ow">and</span>
                        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;restore_new_name&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;new_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;restore_new_name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">_each_vm_to_restore</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;new_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Delete&quot;</span> <span class="o">+</span> <span class="n">_each_vm_to_restore</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;new_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_each_vm_to_restore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_advanced_vm_restore_options</span><span class="p">(</span><span class="n">_each_vm_to_restore</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">)</span>

        <span class="c1"># prepare json</span>
        <span class="n">request_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_restore_json</span><span class="p">(</span><span class="n">restore_option</span><span class="o">=</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;diskLevelVMRestoreOption&quot;</span><span class="p">][</span><span class="s2">&quot;advancedRestoreOptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span><span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span><span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;volumeRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_volumeRstOption</span><span class="p">(</span>
            <span class="n">restore_option</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">request_json</span>

<div class="viewcode-block" id="VirtualServerSubclient.backup"><a class="viewcode-back" href="../../../source/cvpysdk.subclients.html#cvpysdk.subclients.vssubclient.VirtualServerSubclient.backup">[docs]</a>    <span class="k">def</span> <span class="nf">backup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">backup_level</span><span class="o">=</span><span class="s2">&quot;Incremental&quot;</span><span class="p">,</span>
               <span class="n">incremental_backup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">incremental_level</span><span class="o">=</span><span class="s1">&#39;BEFORE_SYNTH&#39;</span><span class="p">,</span>
               <span class="n">collect_metadata</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">advanced_options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">schedule_pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runs a backup job for the subclient of the level specified.</span>

<span class="sd">            Args:</span>
<span class="sd">                backup_level            (str)   --  level of backup the user wish to run</span>
<span class="sd">                                                    Full / Incremental / Differential /</span>
<span class="sd">                                                    Synthetic_full</span>

<span class="sd">                incremental_backup      (bool)  --  run incremental backup</span>
<span class="sd">                                                    only applicable in case of Synthetic_full backup</span>

<span class="sd">                incremental_level       (str)   --  run incremental backup before/after synthetic full</span>
<span class="sd">                                                    BEFORE_SYNTH / AFTER_SYNTH</span>
<span class="sd">                                                    only applicable in case of Synthetic_full backup</span>

<span class="sd">                collect_metadata        (bool)  --  Collect Meta data for the backup</span>

<span class="sd">                advanced_options       (dict)  --  advanced backup options to be included while</span>
<span class="sd">                                                    making the request</span>
<span class="sd">                    options:</span>
<span class="sd">                        create_backup_copy_immediately  --  Run Backup copy just after snap backup</span>
<span class="sd">                        backup_copy_type                --  Backup Copy level using storage policy</span>
<span class="sd">                                                            or subclient rule</span>

<span class="sd">                schedule_pattern (dict) -- scheduling options to be included for the task</span>

<span class="sd">                        Please refer schedules.schedulePattern.createSchedule()</span>
<span class="sd">                                                                    doc for the types of Jsons</span>

<span class="sd">            Returns:</span>
<span class="sd">                object - instance of the Job class for this backup job if its an immediate Job</span>

<span class="sd">                         instance of the Schedule class for the backup job if its a scheduled Job</span>

<span class="sd">            Raises:</span>
<span class="sd">                SDKException:</span>
<span class="sd">                    if backup level specified is not correct</span>

<span class="sd">                    if response is empty</span>

<span class="sd">                    if response is not success</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">backup_level</span> <span class="o">=</span> <span class="n">backup_level</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">backup_level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;differential&#39;</span><span class="p">,</span> <span class="s1">&#39;synthetic_full&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;103&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">advanced_options</span> <span class="ow">or</span> <span class="n">schedule_pattern</span><span class="p">:</span>
            <span class="n">request_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backup_json</span><span class="p">(</span>
                <span class="n">backup_level</span><span class="o">=</span><span class="n">backup_level</span><span class="p">,</span>
                <span class="n">incremental_backup</span><span class="o">=</span><span class="n">incremental_backup</span><span class="p">,</span>
                <span class="n">incremental_level</span><span class="o">=</span><span class="n">incremental_level</span><span class="p">,</span>
                <span class="n">advanced_options</span><span class="o">=</span><span class="n">advanced_options</span><span class="p">,</span>
                <span class="n">schedule_pattern</span><span class="o">=</span><span class="n">schedule_pattern</span>
            <span class="p">)</span>

            <span class="n">backup_service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commcell_object</span><span class="o">.</span><span class="n">_services</span><span class="p">[</span><span class="s1">&#39;CREATE_TASK&#39;</span><span class="p">]</span>

            <span class="n">flag</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commcell_object</span><span class="o">.</span><span class="n">_cvpysdk_object</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
                <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="n">backup_service</span><span class="p">,</span> <span class="n">request_json</span>
            <span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_backup_response</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">VirtualServerSubclient</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="n">backup_level</span><span class="o">=</span><span class="n">backup_level</span><span class="p">,</span>
                                                              <span class="n">incremental_backup</span><span class="o">=</span><span class="n">incremental_backup</span><span class="p">,</span>
                                                              <span class="n">incremental_level</span><span class="o">=</span><span class="n">incremental_level</span><span class="p">,</span>
                                                              <span class="n">collect_metadata</span><span class="o">=</span><span class="n">collect_metadata</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_advanced_backup_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates the advanced backup options dict</span>

<span class="sd">            Args:</span>
<span class="sd">                options         (dict)  --  advanced backup options that are to be included</span>
<span class="sd">                                            in the request</span>
<span class="sd">                    create_backup_copy_immediately  --  Run Backup copy just after snap backup</span>
<span class="sd">                    backup_copy_type                --  Backup Copy level using storage policy</span>
<span class="sd">                                                        or subclient rule</span>

<span class="sd">            Returns:</span>
<span class="sd">            (dict)                      --  generated advanced options dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">final_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VirtualServerSubclient</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_advanced_backup_options</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;create_backup_copy_immediately&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">final_dict</span><span class="p">[</span><span class="s1">&#39;dataOpt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;createBackupCopyImmediately&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;create_backup_copy_immediately&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
                <span class="s1">&#39;backupCopyType&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;backup_copy_type&#39;</span><span class="p">,</span> <span class="s1">&#39;USING_STORAGE_POLICY_RULE&#39;</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="n">final_dict</span>

    <span class="k">def</span> <span class="nf">_prepare_blr_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>

        <span class="k">if</span> <span class="s2">&quot;destination_vendor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">:</span>
            <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_vendor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">_vendor_id</span>

        <span class="c1"># set all the restore defaults</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_restore_defaults</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>

        <span class="c1"># Restore Options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">_restore_association</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subClientEntity</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_virtualServerRstOption</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>

        <span class="c1"># Virtual Server RST option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_allocation_policy_json</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_diskLevelVMRestoreOption</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_vcenter_instance</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="n">_vm_browse_path_nodes_json</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c1"># Disk Level  VM Restore Options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_default_restore_settings</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="n">new_name</span> <span class="o">=</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;new_name&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_each_vm_to_restore</span> <span class="ow">in</span> <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;vm_to_restore&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;prefix&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;new_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">_each_vm_to_restore</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;new_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_each_vm_to_restore</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_advanced_vm_restore_options_blr</span><span class="p">(</span><span class="n">_each_vm_to_restore</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">)</span>
            <span class="n">_vm_browse_path_nodes_json</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vm_browse_path_nodes</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;diskLevelVMRestoreOption&quot;</span><span class="p">][</span><span class="s2">&quot;advancedRestoreOptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># prepare json</span>
        <span class="n">request_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_restore_json</span><span class="p">(</span><span class="n">restore_option</span><span class="o">=</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span><span class="s2">&quot;vmBrowsePathNodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_vm_browse_path_nodes_json</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span><span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;virtualServerRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;options&quot;</span><span class="p">][</span><span class="s2">&quot;restoreOptions&quot;</span><span class="p">][</span><span class="s2">&quot;volumeRstOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_volumeRstOption</span><span class="p">(</span>
            <span class="n">restore_option</span><span class="p">)</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;subTasks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;subTask&quot;</span><span class="p">][</span><span class="s2">&quot;operationType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1007</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">][</span><span class="s2">&quot;associations&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;_type_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;TMMsg_TaskInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">request_json</span><span class="p">[</span><span class="s2">&quot;taskInfo&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">request_json</span>

    <span class="k">def</span> <span class="nf">_vm_browse_path_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;browsePath&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;vmGUID&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;guid&quot;</span><span class="p">],</span>
            <span class="s2">&quot;esxHost&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;esxHost&quot;</span><span class="p">],</span>
            <span class="s2">&quot;datastore&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;Datastore&quot;</span><span class="p">],</span>
            <span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">],</span>
            <span class="s2">&quot;vmDataStore&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;Datastore&quot;</span><span class="p">],</span>
            <span class="s2">&quot;vmEsxHost&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;esxHost&quot;</span><span class="p">],</span>
            <span class="s2">&quot;vmeResourcePoolPath&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">],</span>
            <span class="s2">&quot;isMetadataAvaiable&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_json_restore_default_restore_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;setter for  the default restore settings in block level json&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">restore_option</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SDKException</span><span class="p">(</span><span class="s1">&#39;Subclient&#39;</span><span class="p">,</span> <span class="s1">&#39;101&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;diskLevelVMRestoreOption&quot;</span><span class="p">][</span><span class="s2">&quot;defaultRestoreSettings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;esxHost&quot;</span><span class="p">:</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;esx_host&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Datastore&quot;</span><span class="p">:</span> <span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;datastore&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">:</span> <span class="n">restore_option</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;resource_pool&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">),</span>
            <span class="s2">&quot;blrRecoveryOpts&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_blrRecoveryOpts</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_allocation_policy_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_virtualserver_option_restore_json</span><span class="p">[</span><span class="s2">&quot;allocationPolicy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;flags&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;instanceEntity&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flags&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;policyType&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flags&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;vmAllocPolicyId&quot;</span><span class="p">:</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;target_id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;vmAllocPolicyName&quot;</span><span class="p">:</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;target_name&quot;</span><span class="p">]</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_prepare_blr_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="n">request_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_blr_json</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>

        <span class="n">xml_string</span> <span class="o">=</span> <span class="n">xmltodict</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span>
        <span class="n">plans</span> <span class="o">=</span> <span class="n">Plans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_commcell_object</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;EVGui_SetVMBlockLevelReplicationReq subclientId=&quot;{5}&quot; opType=&quot;3&quot;&gt;</span>
<span class="sd">            &lt;blockLevelReplicationTaskXML&gt;&lt;![CDATA[{0}]]&gt;&lt;/blockLevelReplicationTaskXML&gt;</span>
<span class="sd">            &lt;subClientProperties&gt;</span>
<span class="sd">            &lt;subClientEntity clientId=&quot;{1}&quot; applicationId=&quot;106&quot; instanceId=&quot;{2}&quot; backupsetId=&quot;{3}&quot;/&gt;</span>
<span class="sd">            &lt;planEntity planId=&quot;{4}&quot;/&gt;</span>
<span class="sd">            &lt;/subClientProperties&gt;</span>
<span class="sd">            &lt;/EVGui_SetVMBlockLevelReplicationReq&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">xml_string</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client_object</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_instance_object</span><span class="o">.</span><span class="n">instance_id</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_backupset_object</span><span class="o">.</span><span class="n">backupset_id</span><span class="p">,</span>
                <span class="n">plans</span><span class="o">.</span><span class="n">all_plans</span><span class="p">[</span><span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;plan_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_subclient_id</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_set_advanced_vm_restore_options_blr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vm_to_restore</span><span class="p">,</span> <span class="n">restore_option</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;set the advanced restore options for all vm in restore</span>

<span class="sd">        vm_to_restore : Name of the VM to restore</span>

<span class="sd">        restore_option: restore options that need to be set for advanced restore option</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vm_names</span><span class="p">,</span> <span class="n">vm_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vm_ids_and_names_dict</span><span class="p">()</span>

        <span class="c1"># populate restore source item</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_to_restore</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_to_restore</span><span class="p">]</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s1">&#39;paths&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">vm_ids</span><span class="p">[</span><span class="n">vm_to_restore</span><span class="p">])</span>
        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;resourcePoolPath&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>

        <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;nics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;sourceNetwork&quot;</span><span class="p">:</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;source_network&quot;</span><span class="p">],</span>
            <span class="s2">&quot;destinationNetwork&quot;</span><span class="p">:</span> <span class="n">restore_option</span><span class="p">[</span><span class="s2">&quot;destination_network&quot;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">temp_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json_restore_advancedRestoreOptions</span><span class="p">(</span><span class="n">restore_option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_advanced_restore_option_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dict</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Commvault Systems Inc. All Rights Reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>